<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Clair Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="Documentation for Clair.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "coal";
            window.path_to_searchindex_js = "searchindex-4a0fbf53.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-27196b94.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">Clair Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>
                        <a href="https://github.com/quay/clair" title="Git repository" aria-label="Git repository">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="what-is-clair"><a class="header" href="#what-is-clair">What is Clair</a></h1>
<p>Clair is an application for parsing image contents and reporting vulnerabilities affecting the contents. This is done via static analysis and not at runtime.</p>
<p>Clair supports the extraction of contents and assignment of vulnerabilities from the following official base containers:</p>
<ul>
<li>Ubuntu</li>
<li>Debian</li>
<li>RHEL</li>
<li>Suse</li>
<li>Oracle</li>
<li>Alpine</li>
<li>AWS Linux</li>
<li>VMWare Photon</li>
<li>Python</li>
</ul>
<p>The above list defines Clair’s current support matrix.</p>
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<p>Clair v4 utilizes the <a href="https://quay.github.io/claircore/">ClairCore</a> library as its engine for examining contents and reporting vulnerabilities. At a high level you can consider Clair a service wrapper to the functionality provided in the ClairCore library.</p>
<p><img src="clairv4_arch.png" alt="diagram of clairV4 highlevel architecture"></p>
<p>The above diagram expresses the separation of concerns between Clair and the ClairCore library. Most development involving new distributions, vulnerability sources, and layer indexing will occur in ClairCore.</p>
<h2 id="how-clair-works"><a class="header" href="#how-clair-works">How Clair Works</a></h2>
<p>Clair’s analysis is broken into three distinct parts.</p>
<h3 id="indexing"><a class="header" href="#indexing">Indexing</a></h3>
<p>Indexing starts with submitting a Manifest to Clair. On receipt, Clair will fetch layers, scan their contents, and return an intermediate representation called an IndexReport.</p>
<p>Manifests are Clair’s representation of a container image. Clair leverages the fact that OCI Manifests and Layers are content-addressed to reduce duplicated work.</p>
<p>Once a Manifest is indexed, the IndexReport is persisted for later retrieval.</p>
<h3 id="matching"><a class="header" href="#matching">Matching</a></h3>
<p>Matching is taking an IndexReport and correlating vulnerabilities affecting the manifest the report represents.</p>
<p>Clair is continually ingesting new security data and a request to the matcher will always provide you with the most up to date vulnerability analysis of an IndexReport.</p>
<p><em>How we implement indexing and matching in detail is covered in <a href="https://quay.github.io/claircore/">ClairCore’s</a> documentation.</em></p>
<h3 id="notifications"><a class="header" href="#notifications">Notifications</a></h3>
<p>Clair implements a notification service.</p>
<p>When new vulnerabilities are discovered, the notifier service will determine if these vulnerabilities affect any indexed Manifests. The notifier will then take action according to its configuration.</p>
<h3 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h3>
<p>At this point you’ll probably want to check out <a href="#getting-started-with-clair">Getting Started With Clair</a>.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="how-tos"><a class="header" href="#how-tos">How Tos</a></h1>
<p>The following sections provide instructions on accomplish specific goals in Clair.</p>
<ul>
<li><a href="#api-definition">API Definition</a></li>
<li><a href="#deploying-clair">Deployment Models</a></li>
<li><a href="#getting-started-with-clair">Getting Started</a></li>
<li><a href="#testing-clair">Testing ClairV4</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="getting-started-with-clair"><a class="header" href="#getting-started-with-clair">Getting Started With Clair</a></h1>
<h2 id="releases"><a class="header" href="#releases">Releases</a></h2>
<p>All of the source code needed to build clair is packaged as an archive and
attached to the release. Releases are tracked at the <a href="https://github.com/quay/clair/releases">github releases</a>.</p>
<p>The release artifacts also include the clairctl command line tool.</p>
<h2 id="official-containers"><a class="header" href="#official-containers">Official Containers</a></h2>
<p>Clair is officially packaged and released as a container at
<a href="https://quay.io/repository/projectquay/clair">quay.io/projectquay/clair</a>. The <code>latest</code> tag tracks the git development branch,
and version tags are built from the corresponding release.</p>
<h2 id="running-clair"><a class="header" href="#running-clair">Running Clair</a></h2>
<p>The easiest way to get Clair up and running for test purposes is to use our <a href="#testing-clair">local dev environment</a></p>
<p>If you’re the hands on type who wants to get into the details however, continue reading.</p>
<h2 id="modes"><a class="header" href="#modes">Modes</a></h2>
<p>Clair can run in several modes. <a href="#indexer-1">Indexer</a>, <a href="#matcher-1">matcher</a>, <a href="#notifier-1">notifier</a> or combo mode. In combo mode, everything runs in a single OS process.</p>
<p>If you are just starting with Clair you will most likely want to start with combo mode and venture out to a distributed deployment once acquainted.</p>
<p>This how-to will demonstrate combo mode and introduce some further reading on a distributed deployment.</p>
<h2 id="postgres"><a class="header" href="#postgres">Postgres</a></h2>
<p>Clair uses PostgreSQL for its data persistence. Migrations are supported so you should only need to point Clair to a fresh database and have it do the setup for you.</p>
<p>We will assume you have setup a postgres database and it’s reachable with the following connection string:
<code>host=clair-db port=5432 user=clair dbname=clair sslmode=disable</code>. Adjust for your environment accordingly.</p>
<h2 id="starting-clair-in-combo-mode"><a class="header" href="#starting-clair-in-combo-mode">Starting Clair In Combo Mode</a></h2>
<p>At this point, you should either have built Clair from source or have pulled the container. In either case, we will assume that the <code>clair-db</code> hostname will resolve to your postgres database.</p>
<p><em>You may need to configure <a href="https://docs.docker.com/network/">docker</a> or <a href="https://podman.io/getting-started/network.html">podman</a> networking if you are utilizing containers. This is out of scope for this how-to.</em></p>
<p>A basic config for combo mode can be found <a href="https://github.com/quay/clair/blob/main/config.yaml.sample">here</a>. Make sure to edit this config with your database settings and set “migrations” to <code>true</code> for all mode stanzas. In this basic combo mode, all “connstring” fields should point to the same database and any *_addr fields are simply ignored. For more details see the <a href="#config">config reference</a> and <a href="#deploying-clair">deployment models</a></p>
<p>Clair has 3 requirements to start:</p>
<ul>
<li>The <code>mode</code> flag or <code>CLAIR_MODE</code> environment variable specifying what mode this instance will run in.</li>
<li>The <code>conf</code> flag or <code>CLAIR_CONF</code> environment variable specifying where Clair can find its configuration.</li>
<li>A yaml document providing Clair’s configuration.</li>
</ul>
<p>If you are running a container, you can <a href="https://docs.docker.com/storage/volumes/">mount</a> a Clair config and set the <code>CLAIR_CONF</code> environment variable to the corresponding path.</p>
<pre><code>CLAIR_MODE=combo
CLAIR_CONF=/path/to/mounted/config.yaml
</code></pre>
<p>If you are running a Clair binary directly, its likely easiest to use the command line.</p>
<pre><code>clair -conf "path/to/config.yaml" -mode "combo"
</code></pre>
<h2 id="submitting-a-manifest"><a class="header" href="#submitting-a-manifest">Submitting A Manifest</a></h2>
<p>The simplest way to submit a manifest to your running Clair is utilizing <a href="#clairctl">clairctl</a>. This is a CLI tool capable of grabbing image manifests from public repositories and submitting them for analysis.
The command will be in the Clair container, but can also be installed locally by running the following command:</p>
<pre><code>go install github.com/quay/clair/v4/cmd/clairctl@latest
</code></pre>
<p>You can submit a manifest to ClairV4 via the following command.</p>
<pre><code class="language-shell">$ clairctl report --host ${net_address_of_clair} ${image_tag}
</code></pre>
<p>You will need to add the <code>config</code> flag if you are using a PSK authentication (as in the <a href="#testing-clair">local dev environment</a> setup, for example).</p>
<pre><code class="language-shell">$ clairctl report --config local-dev/clair/config.yaml --host ${net_address_of_clair} ${image_tag}
</code></pre>
<p>By default, <code>clairctl</code> will look for Clair at <code>localhost:6060</code> or the environment variable <code>CLAIR_API</code>, and for a configuration at <code>config.yaml</code> or the environment variable <code>CLAIR_CONF</code>.</p>
<p>If everything is configured correctly, you should see some output like the following informing you of vulnerabilities affecting the supplied image.</p>
<pre><code class="language-shell">$ clairctl report ubuntu:focal
ubuntu:focal found bash        5.0-6ubuntu1.1         CVE-2019-18276
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2017-11164
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2019-20838
ubuntu:focal found libpcre3    2:8.39-12build1        CVE-2020-14155
ubuntu:focal found libsystemd0 245.4-4ubuntu3.2       CVE-2018-20839
ubuntu:focal found libsystemd0 245.4-4ubuntu3.2       CVE-2020-13776
ubuntu:focal found libtasn1-6  4.16.0-2               CVE-2018-1000654
ubuntu:focal found libudev1    245.4-4ubuntu3.2       CVE-2018-20839
ubuntu:focal found libudev1    245.4-4ubuntu3.2       CVE-2020-13776
ubuntu:focal found login       1:4.8.1-1ubuntu5.20.04 CVE-2013-4235
ubuntu:focal found login       1:4.8.1-1ubuntu5.20.04 CVE-2018-7169
ubuntu:focal found coreutils   8.30-3ubuntu2          CVE-2016-2781
ubuntu:focal found passwd      1:4.8.1-1ubuntu5.20.04 CVE-2013-4235
ubuntu:focal found passwd      1:4.8.1-1ubuntu5.20.04 CVE-2018-7169
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-10543
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-10878
ubuntu:focal found perl-base   5.30.0-9build1         CVE-2020-12723
ubuntu:focal found tar         1.30+dfsg-7            CVE-2019-9923
ubuntu:focal found dpkg        1.19.7ubuntu3          CVE-2017-8283
ubuntu:focal found gpgv        2.2.19-3ubuntu2        CVE-2019-13050
ubuntu:focal found libc-bin    2.31-0ubuntu9          CVE-2016-10228
ubuntu:focal found libc-bin    2.31-0ubuntu9          CVE-2020-6096
ubuntu:focal found libc6       2.31-0ubuntu9          CVE-2016-10228
ubuntu:focal found libc6       2.31-0ubuntu9          CVE-2020-6096
ubuntu:focal found libgcrypt20 1.8.5-5ubuntu1         CVE-2019-12904
</code></pre>
<p>To test locally-built images, you’ll need to push them to a registry that is accessible by the Clair service and the <code>clairctl</code> command.
A local registry can be used for this, but the specifics of configuration vary by registry and container runtime.
Consult the relevant documentation for more information.</p>
<h2 id="whats-next"><a class="header" href="#whats-next">What’s Next</a></h2>
<p>Now that you see the basic usage of Clair, you can checkout our <a href="#deploying-clair">deployment models</a> to learn different ways of deploying.</p>
<p>You may also be curious about how <code>clairctl</code> did that work. Check out our <a href="#api-definition">API definition</a> to understand how an application interacts with Clair.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="deploying-clair"><a class="header" href="#deploying-clair">Deploying Clair</a></h1>
<p>Clair v4 was designed with flexible deployment architectures in mind.
An operator is free to choose a deployment model which scales to their use cases.</p>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>Before jumping directly into the models, its important to note that Clair is designed to use a single configuration file across all node types.
This design decision makes it very easy to deploy on systems like Kubernetes and OpenShift.</p>
<p>See <a href="#config">Config Reference</a></p>
<h2 id="combined-deployment"><a class="header" href="#combined-deployment">Combined Deployment</a></h2>
<p>In a combined deployment, all the Clair processes run in a single OS process.
This is by far the easiest deployment model to configure as it involves the least moving parts.</p>
<p>A load balancer is still recommended if you plan on performing TLS termination.
Typically this will be a OpenShift route or a Kubernetes ingress.</p>
<p><img src="howto/clairv4_combo_single_db.png" alt="combo mode single db deployment diagran"></p>
<p>In the above diagram, Clair is running in combo mode and talking to a single database.
To configure this mode, you will provide all node types the same database and start Clair in <strong>combo</strong> mode.</p>
<pre><code>...
indexer:
    connstring: "host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
matcher:
    connstring: "host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
notifier:
    connstring: "host=clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
</code></pre>
<p>In this mode, any configuration informing Clair how to talk to other nodes is ignored;
it is not needed as all intra-process communication is done directly.</p>
<p>For added flexibility, it’s also supported to split the databases while in combo mode.</p>
<p><img src="howto/clairv4_combo_multi_db.png" alt="combo mode multiple db deployment diagran"></p>
<p>In the above diagram, Clair is running in combo mode but database load is split between multiple databases.
Since Clair is conceptually a set of micro-services, its processes do not share database tables even when combined into the same OS process.</p>
<p>To configure this mode, you would provide each process its own “connstring” in the configuration.</p>
<pre><code>...
indexer:
    connstring: "host=indexer-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
matcher:
    connstring: "host=matcher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
notifier:
    connstring: "host=notifier-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    ...
</code></pre>
<h2 id="distributed-deployment"><a class="header" href="#distributed-deployment">Distributed Deployment</a></h2>
<p>If your application needs to asymmetrically scale or you expect high load you may want to consider a distributed deployment.</p>
<p>In a distributed deployment, each Clair process runs in its own OS process.
Typically this will be a Kubernetes or OpenShift Pod.</p>
<p>A load balancer <strong>must</strong> be setup in this deployment model.
The load balancer will route traffic between Clair nodes along with routing API requests via <a href="https://devcentral.f5.com/s/articles/the-three-http-routing-patterns-you-should-know-30764">path based routing</a> to the correct services.
In a Kubernetes or OpenShift deployment this is usually handled with the <code>Service</code> and <code>Route</code> abstractions.
If deploying on bare metal, a load balancer will need to be configured appropriately.</p>
<p><img src="howto/clairv4_distributed_multi_db.png" alt="distributed mode multiple db deployment diagran"></p>
<p>In the above diagram, a load balancer is configured to route traffic coming from the client to the correct service.
This routing is path based and requires a layer 7 load balancer.
Traefik, Nginx, and HAProxy are all capable of this.
As mentioned above, this functionality is native to OpenShift and Kubernetes.</p>
<p>In this configuration, you’d supply each process with database connection strings and addresses for their dependent services.
Each OS process will need to have its “mode” CLI flag or environment variable set to the appropriate value.
See <a href="#config">Config Reference</a></p>
<pre><code>...
indexer:
    connstring: "host=indexer-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
matcher:
    connstring: "host=matcher-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    indexer_addr: "indexer-service"
    ...
notifier:
    connstring: "host=notifier-clairdb user=pqgotest dbname=pqgotest sslmode=verify-full"
    indexer_addr: "indexer-service"
    matcher_addr: "matcher-service"
    ...
</code></pre>
<p>Keep in mind a config file per process is not need.
Processes only use the values necessary for their configured mode.</p>
<h2 id="tls-termination"><a class="header" href="#tls-termination">TLS Termination</a></h2>
<p>It’s recommended to offload TLS termination to the load balancing infrastructure.
This design choice is due to the ubiquity of Kubernetes and OpenShift infrastructure already providing this facility.</p>
<p>If this is not possible for some reason, it is possible to have processes terminate TLS by using the <code>$.tls</code> configuration key.
A load balancer is still required.</p>
<h2 id="disk-usage-considerations"><a class="header" href="#disk-usage-considerations">Disk Usage Considerations</a></h2>
<p>By default, Clair will store container layers in <code>/var/tmp</code> while in use.
This can be changed by setting the <code>TMPDIR</code> environment variable.
There’s currently no way to change this in the configuration file.</p>
<p>The disk space needed depends on the precise layers being indexed at any one time,
but a good approximation is twice as large as the largest (uncompressed size) layer in the corpus.</p>
<h2 id="more-on-path-routing"><a class="header" href="#more-on-path-routing">More On Path Routing</a></h2>
<p>If you are considering a distributed deployment you will need more details on <a href="https://devcentral.f5.com/s/articles/the-three-http-routing-patterns-you-should-know-30764">path based routing</a>.</p>
<p>Learn how to grab our OpenAPI spec <a href="#api-definition">here</a> and either start up a local dev instance of the swagger editor or load the spec file into the <a href="https://petstore.swagger.io/#/">online editor</a>.</p>
<p>You will notice particular API paths are grouped by the services which implement them.
This is your guide to configure your layer 7 load balancer correctly.</p>
<p>When the load balancer encounters a particular path prefix it must send those request to the correct set of Clair nodes.</p>
<p>For example, this is how we configure Traefik in our local development environment:</p>
<pre><code>- "traefik.enable=true"
- "traefik.http.routers.notifier.entrypoints=clair"
- "traefik.http.routers.notifier.rule=PathPrefix(`/notifier`)"
- "traefik.http.routers.notifier.service=notifier"
- "traefik.http.services.notifier.loadbalancer.server.port=6000"
</code></pre>
<p>This configuration is saying “take any paths prefixes of /notifier/ and send them to the notifier services on port 6000”.</p>
<p>Every load balancer will have their own way to perform path routing.
Check the documentation for your infrastructure of choice.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="api-definition"><a class="header" href="#api-definition">API Definition</a></h1>
<p>Clair provides its API definition via an OpenAPI specification. You can view our OpenAPI spec <a href="https://github.com/quay/clair/tree/main/httptransport/api/v1">here</a>.</p>
<p>The OpenAPI spec can be used in a variety of ways.</p>
<ul>
<li>Generating http clients for your application</li>
<li>Validating data returned from Clair</li>
<li>Importing into a rest client such as <a href="https://learning.postman.com/docs/integrations/available-integrations/working-with-openAPI/">Postman</a></li>
<li>API documentation via <a href="https://petstore.swagger.io/#/">Swagger Editor</a></li>
</ul>
<p>See <a href="#testing-clair">Testing Clair</a> to learn how the local dev tooling starts a local swagger editor. This is handy for making changes to the spec in real time.</p>
<p>See <a href="#clair-container-analyzer">API Reference</a> for a markdown rendered API reference.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="testing-clair"><a class="header" href="#testing-clair">Testing Clair</a></h1>
<p>We provide dev tooling in order to quickly get a fully configured Clair and Quay environment stood up locally.
This environment can be used to test and develop Clair’s Quay integration.</p>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<h3 id="make"><a class="header" href="#make">Make</a></h3>
<p>Make is used to stand up the local dev environment.
Make is readily available in just about every package manager you can think of.
It’s very likely your workstation already has make on it.</p>
<h3 id="podmandocker-and-docker-compose"><a class="header" href="#podmandocker-and-docker-compose">Podman/Docker and Docker Compose</a></h3>
<p>Currently our local dev tooling is supported by docker and docker-compose.
Podman should work fine since v3.0.</p>
<p>Docker version 19.03.11 and docker-compose version 1.28.6 are confirmed working.
Our assumption is most recent versions will not have an issue running the local dev tooling.</p>
<p>See <a href="https://podman.io/get-started">Get Started with Podman</a>.</p>
<h3 id="go-toolchain"><a class="header" href="#go-toolchain">Go Toolchain</a></h3>
<p>Go 1.20 or higher is required.</p>
<p>See <a href="https://golang.org/doc/install">Install Golang</a>.</p>
<h2 id="starting-a-cluster"><a class="header" href="#starting-a-cluster">Starting a cluster</a></h2>
<pre><code>git clone git@github.com:quay/clair.git
cd clair
docker-compose up -d
# or: make local-dev
# or: make local-dev-debug
# or: make local-dev-quay
</code></pre>
<p>After the local development environment successfully starts, the following infrastructure is available to you:</p>
<ul>
<li>
<p><code>localhost:8080</code></p>
<p>Dashboards and debugging services – See the traefik configs in <code>local-dev/traefik</code> for where the various services are served.</p>
</li>
<li>
<p><code>localhost:6060</code></p>
<p>Clair services.</p>
</li>
<li>
<p>Quay (if started)</p>
<p>Quay will be started in a single node, local storage configuration.
A random port will be forwarded from localhost, see <code>podman port</code> for the mapping.</p>
</li>
<li>
<p>PostgreSQL</p>
<p>PostgreSQL will have a random port forwarded from localhost to the database server.
See <code>local-dev/clair/init.sql</code> for credentials and permissions and <code>podman port</code> for the mapping.</p>
</li>
</ul>
<h3 id="debugging"><a class="header" href="#debugging">Debugging</a></h3>
<p>With the <code>local-dev-debug</code> make target the operator has access to some more useful tools:</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Tool</th><th>Description</th><th>URL</th><th>Credentials</th></tr>
</thead>
<tbody>
<tr><td>pgAdmin</td><td>Postgres administration</td><td><a href="http://localhost:8080/pgadmin">localhost:8080/pgadmin</a></td><td>clair@clair.com:clair</td></tr>
<tr><td>jaeger</td><td>Distributed tracing</td><td><a href="http://localhost:8080/jaeger">localhost:8080/jaeger</a></td><td>-</td></tr>
<tr><td>prometheus</td><td>Metrics collection and querying</td><td><a href="http://localhost:8080/prom">localhost:8080/prom</a></td><td>-</td></tr>
<tr><td>pyroscope</td><td>Continuous profiling</td><td><a href="http://localhost:8080/pyroscope">localhost:8080/pyroscope</a></td><td>-</td></tr>
<tr><td>grafana</td><td>Metrics dashboards</td><td><a href="http://localhost:8080/grafana">localhost:8080/grafana</a></td><td>admin:admin</td></tr>
</tbody>
</table>
</div>
<h2 id="pushing-to-the-local-quay"><a class="header" href="#pushing-to-the-local-quay">Pushing to the Local Quay</a></h2>
<p>As mentioned above, Quay is forwarded to a random port on the host.
You can connect to the server on that port and create a account.
Creating an account named <code>admin</code> will ensure you are a super user.
An email is required, but is not validated.
You’ll also need to create a namespace.</p>
<p>To push to Quay, you’ll need to exec into the skopeo container:</p>
<pre><code class="language-shell">docker-compose exec -it skopeo /usr/bin/skopeo copy --dest-creds '&lt;user&gt;:&lt;pass&gt;' --dest-tls-verify=false &lt;src&gt; docker://clair-quay:8080/&lt;namespace&gt;/&lt;repo&gt;:&lt;tag&gt;
</code></pre>
<p>Note that skopeo expects its image arguments in <a href="https://github.com/containers/image/blob/main/docs/containers-transports.5.md"><code>containers-transports(5)</code></a> format.</p>
<h2 id="viewing-results"><a class="header" href="#viewing-results">Viewing Results</a></h2>
<p>By default, Quay displays security scanner results on the Tags page of the given repository.</p>
<h2 id="making-changes-to-configuration"><a class="header" href="#making-changes-to-configuration">Making changes to configuration</a></h2>
<p>You may want to play with either Clair or Quay’s configuration.
If so, the configuration files can be found inside the repository at <code>local-dev/quay/config.yaml</code> and <code>local-dev/clair/config.yaml</code>.
Any changes to the configs will require a restart of the relevant service.
The quay-specific clair config is autogenerated, see the <code>Makefile</code>.</p>
<h2 id="tearing-it-down"><a class="header" href="#tearing-it-down">Tearing it down</a></h2>
<pre><code>docker-compose down
</code></pre>
<p>will rip the entire environment down.</p>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<p>The most common issue encountered when standing up the dev environment is port conflicts.
Make sure that you do not have any other processes listening on any of the ports outlined above.</p>
<p>The second issue you may face is your Docker resource settings being too constrained to support the local dev stack.
This is typically seen on Docker4Mac since a VM is used with a specific set of resources configured.
See <a href="https://docs.docker.com/docker-for-mac/">Docker For Mac Manual</a> for instructions on how to change these resources.</p>
<p>If <code>docker-compose</code> reports errors like <code>Unsupported config option for services.activemq: 'profiles'</code>, the <code>docker-compose</code> version is too old and you’ll need to upgrade.
Consult the relevant documentation for your environment for instructions.</p>
<p>Lastly, you can view traefik’s ui at <a href="http://localhost:8080/dashboard/"><code>localhost:8080/dashboard/</code></a>.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="concepts"><a class="header" href="#concepts">Concepts</a></h1>
<p>The following sections give a conceptual overview of how Clair works internally.</p>
<ul>
<li><a href="#internal">Internal API</a></li>
<li><a href="#authentication">Authentication</a></li>
<li><a href="#notifications-1">Notifications</a></li>
<li><a href="#updaters-and-airgap">Updaters and Airgap</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="indexing-1"><a class="header" href="#indexing-1">Indexing</a></h1>
<p>The <a href="#indexer-1">Indexer</a> service is responsble for “indexing a manifest”.</p>
<p>Indexing involves taking a manifest representing a container image and computing its constituent parts. The indexer is trying to discover what packages exist in the image, what distribution the image is derived from, and what package repositories are used within the image. Once this information is computed it is persisted in an IndexReport.</p>
<p>The IndexReport is an intermediate data structure describing the contents of a container image. This report can be fed to a <a href="#matcher-1">Matcher</a> node for vulnerability analysis.</p>
<h2 id="content-addressability"><a class="header" href="#content-addressability">Content Addressability</a></h2>
<p>ClairV4 treats all manifests and layers as <a href="https://en.wikipedia.org/wiki/Content-addressable_storage">content addressable</a>. In the context of ClairV4 this means once we index a specific manifest we will not index it again unless it’s required, and likewise with individual layers. This allows a large reduction in work.</p>
<p>For example, consider how many images in a registry may use “ubuntu:artful” as a base layer. It could be a large majority of images if the developers prefer basing their images off ubuntu. Treating the layers and manifests as content addressable means we will only fetch and scan the base layer once.</p>
<p>There are of course conditions where ClairV4 should re-index a manifest.</p>
<p>When an internal component such as a package scanner is updated, Clair will know to perform the scan with the new package scanner. Clair has enough information to determine that a component has changed and the IndexReport may be different this time around.</p>
<p>A client can track ClairV4’s <code>index_state</code> endpoint to understand when an internal component has changed and subsequently issue re-indexes. See our <a href="#api-definition">api</a> guide to learn how to view our api specification.</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>In summary, you should understand that Indexing is the process Clair uses to understand the contents of layers.</p>
<p>For a more indepth look at indexing check out the <a href="https://quay.github.io/claircore/">ClairCore Documentation</a></p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="matching-1"><a class="header" href="#matching-1">Matching</a></h1>
<p>A <a href="#matcher-1">Matcher</a> node is responsible for matching vulnerabilities to a provided IndexReport.</p>
<p>Matchers by default are also responsible for keeping the database of vulnerabilities up to date. Matchers will typically run a set of Updaters which periodically probe their data sources for new contents, storing new vulnerabilities in the database when discovered.</p>
<p>The matcher API is designed to be called often and will always provide the most up-to-date VulnerabilityReport when queried. This VulnerabilityReport summaries both a manifest’s contents and any vulnerabilities affecting the contents.</p>
<p>See our <a href="#api-definition">api</a> guide to learn how to view our api specification and work with the Matcher api.</p>
<h1 id="remote-matching"><a class="header" href="#remote-matching">Remote Matching</a></h1>
<p>A remote matcher behaves similarly to a matcher, except that it uses api calls to fetch vulnerability data for a provided IndexReport.
Remote matchers are useful when it is not possible to persist data from a given source into the database.</p>
<p>The <code>crda</code> remote matcher is responsible for fetching vulnerabilities from Red Hat Code Ready Dependency Analytics (CRDA).
By default, this matcher serves 100 requests per minute.
The rate-limiting can be lifted by requesting a dedicated API key, which is done via <a href="https://developers.redhat.com/content-gateway/link/3872178">this form</a>.</p>
<h2 id="summary-1"><a class="header" href="#summary-1">Summary</a></h2>
<p>In summary you should understand that a Matcher node provides vulnerability reports given the output of an Indexing process. By default it will also run background Updaters keeping the vulnerability database up-to-date.</p>
<p>For a more indepth look at indexing check out the <a href="https://quay.github.io/claircore/">ClairCore Documentation</a></p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="internal"><a class="header" href="#internal">Internal</a></h1>
<p>Internal endpoints are underneath <code>/api/v1/internal</code> and are meant for
communication between Clair microservices. If Clair is operating in combo mode,
these endpoints may not exist. Any sort of API ingress should disallow clients
to talk to these endpoints.</p>
<p>We do not formally expose these APIs in our OpenAPI spec.
Further information and usage is an effort left to the reader.</p>
<h2 id="updates-diffs"><a class="header" href="#updates-diffs">Updates Diffs</a></h2>
<p>The <code>update_diff/</code> endpoint exposes the api for diffing two update operations.
This is used by the notifier to determine the added and removed vulnerabilities on security databsae update.</p>
<h2 id="update-operation"><a class="header" href="#update-operation">Update Operation</a></h2>
<p>The <code>update_operation</code> endpoint exposes the api for viewing updaters’ activity.
This is used by the notifier to determine if new updates have occurred and triggers an update diff to see what has changed.</p>
<h2 id="affectedmanifest"><a class="header" href="#affectedmanifest">AffectedManifest</a></h2>
<p>The <code>affected_manifest</code> endpoint exposes the api for retreiving affected manifests given a list of Vulnerabilities.
This is used by the notifier to determine the manifests that need to have a notification generated.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="authentication"><a class="header" href="#authentication">Authentication</a></h1>
<p>Previous versions of Clair used <a href="https://github.com/quay/jwtproxy">jwtproxy</a> to gate authentication. For ease of
building and deployment, v4 handles authentication itself.</p>
<p>Authentication is configured by specifying configuration objects underneath the
<code>auth</code> key of the configuration. Multiple authentication configurations may be
present, but they will be used preferentially in the order laid out below.</p>
<h3 id="psk"><a class="header" href="#psk">PSK</a></h3>
<p>Clair implements JWT-based authentication using a pre-shared key.</p>
<h4 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h4>
<p>The <code>auth</code> stanza of the configuration file requires two parameters: <code>iss</code>, which
is the issuer to validate on all incoming requests; and <code>key</code>, which is a base64
encoded symmetric key for validating the requests.</p>
<pre><code class="language-yaml">auth:
  psk:
    key: &gt;-
      MDQ4ODBlNDAtNDc0ZC00MWUxLThhMzAtOTk0MzEwMGQwYTMxCg==
    iss: 'issuer'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="notifications-1"><a class="header" href="#notifications-1">Notifications</a></h1>
<p>ClairV4 implements a notification system.</p>
<p>The notifier service will keep track of new security database updates and inform an interested client if new or removed vulnerabilities affect an indexed manifest.</p>
<p>The interested client can subscribe to notifications via several mechanisms:</p>
<ul>
<li>Webhook delivery</li>
<li>AMQP delivery</li>
<li>STOMP delivery</li>
</ul>
<p>Configuring the notifier is done via the yaml configuration.</p>
<p>See the “Notifier” object in our <a href="#config">config reference</a></p>
<h2 id="a-notification"><a class="header" href="#a-notification">A Notification</a></h2>
<p>When the notifier becomes aware of new vulnerabilities affecting a previously indexed manifest, it will use the configured method(s) to issue notifications about the new changes. Any given notification expresses the <strong>most severe</strong> vulnerability discovered because of the change. This avoids creating a flurry of notifications for the same security database update.</p>
<p>Once a client receives a notification, it should issue a new request against the <a href="#matcher-1">matcher</a> to receive an up-to-date vulnerability report.</p>
<p>The notification schema is the JSON marshaled form of the following types:</p>
<pre><code class="language-go">// Reason indicates the catalyst for a notification
type Reason string
const (
	Added   Reason = "added"
	Removed Reason = "removed"
	Changed Reason = "changed"
)
type Notification struct {
	ID            uuid.UUID        `json:"id"`
	Manifest      claircore.Digest `json:"manifest"`
	Reason        Reason           `json:"reason"`
	Vulnerability VulnSummary      `json:"vulnerability"`
}
type VulnSummary struct {
	Name           string                  `json:"name"`
	Description    string                  `json:"description"`
	Package        *claircore.Package      `json:"package,omitempty"`
	Distribution   *claircore.Distribution `json:"distribution,omitempty"`
	Repo           *claircore.Repository   `json:"repo,omitempty"`
	Severity       string                  `json:"severity"`
	FixedInVersion string                  `json:"fixed_in_version"`
	Links          string                  `json:"links"`
}
</code></pre>
<h2 id="webhook-delivery"><a class="header" href="#webhook-delivery">Webhook Delivery</a></h2>
<p><em>See the “Notifier.Webhook” object in the <a href="#config">config reference</a> for complete configuration details.</em></p>
<p>When you configure notifier for webhook delivery you provide the service with the following pieces of information:</p>
<ul>
<li>A target URL where the webhook will fire</li>
<li>The callback URL where the notifier may be reached including its API path
<ul>
<li>e.g. “http://clair-notifier/notifier/api/v1/notification”</li>
</ul>
</li>
</ul>
<p>When the notifier has determined an updated security database has changed the affected status of an indexed manifest, it will deliver the following JSON body to the configured target:</p>
<pre><code class="language-json">{
  "notification_id": {uuid_string},
  "callback": {url_to_notifications}
}
</code></pre>
<p>On receipt, the server can immediately browse to the URL provided in the callback field.</p>
<h3 id="pagination"><a class="header" href="#pagination">Pagination</a></h3>
<p>The URL returned in the callback field brings the client to a paginated result.</p>
<p>The callback endpoint specification follows:</p>
<pre><code class="language-go">GET /notifier/api/v1/notification/{id}?[page_size=N][next=N]
{
  page: {
    size:    int,      // maximum number of notifications in the response
    next:   string, //  if present, the next id to fetch.
  }
  notifications: [ Notification… ] // array of notifications; max len == page.size
}
</code></pre>
<p>The GET callback request implements a simple bare-minimum paging mechanism.</p>
<p>The “page_size” url param controls how many notifications are returned in a single page.
If not provided a default of 500 is used.</p>
<p>The “next” url param informs Clair the next set of paged notifications to return. If not provided the 0th page is assumed.</p>
<p>A page object accompanying the notification list specifies “next” and “size” fields.</p>
<p>The “next” field returned in the page must be provided as the subsequent request’s “next” url parameter to retrieve the next set of notifications.</p>
<p>The “size” field will simply echo back the request page_size parameter.</p>
<p>When the final page is served to the client the returned “page” data structure will not contain a “next” member.</p>
<p>Therefore the following loop is valid for obtaining all notifications for a notification id in pages of a specified size.</p>
<pre><code>{ page, notifications } = http.Get("http://clairv4/notifier/api/v1/notification/{id}?page_size=1000")

while (page.Next != None) {
    { page, notifications } = http.Get("http://clairv4/notifier/api/v1/notification/{id}?next={page.Next},page_size=1000")
}
</code></pre>
<p><em>Note: If the client specifies a custom page_size it must specify this page_size on every request for accurate responses.</em></p>
<h3 id="deleting-notifications"><a class="header" href="#deleting-notifications">Deleting Notifications</a></h3>
<p>While not mandatory, the client may issue a delete of the notification via a DELETE method. See <a href="#api-definition">api</a> to view the delete api.</p>
<p>Deleting a notification ID will clean up resources in the notifier quicker. Otherwise the notifier will wait a predetermined length of time before clearing delivered notifications from its database.</p>
<h2 id="amqp-delivery"><a class="header" href="#amqp-delivery">AMQP Delivery</a></h2>
<p><em>See the “Notifier.AMQP” object in our <a href="#config">config reference</a> for complete configuration details.</em></p>
<p>The notifier also supports delivering to an AMQP broker. With AMQP delivery you can control whether a callback is delivered to the broker or whether notifications are directly delivered to the queue.</p>
<p>This allows the developer of the AMQP consumer to determine the logic of notification processing.</p>
<p>Note that AMQP delivery only supports AMQP 0.x protocol (e.g. RabbitMQ). If you need to publish notifications on AMQP 1.x message queue (e.g. ActiveMQ), you can use STOMP delivery.</p>
<h3 id="direct-delivery"><a class="header" href="#direct-delivery">Direct Delivery</a></h3>
<p>If the notifier’s configuration specifies <code>direct: true</code> for AMQP, notifications will be delivered directly to the configured exchange.</p>
<p>When <code>direct</code> is set, the <code>rollup</code> property may be set to instruct the notifier to send a max number of notifications in a single AMQP message. This allows a balance between size of the message and number of messages delivered to the queue.</p>
<h2 id="testing-and-development"><a class="header" href="#testing-and-development">Testing and Development</a></h2>
<p>The notifier has a testing mode enabled when it sees the “NOTIFIER_TEST_MODE” environment variable set. It can be set to any value as we only check to see if it exists.</p>
<p>When this environment variable is set, the notifier will begin sending fake notifications to the configured delivery mechanism every “poll_interval” interval. This provides an easy way to implement and test new or existing deliverers.</p>
<p>The notifier will run in this mode until the environment variable is cleared and the service is restarted.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="updaters-and-airgap"><a href="#updaters-and-airgap" class="header">Updaters and Airgap</a></h1>
<h2 id="updaters"><a class="header" href="#updaters">Updaters</a></h2>
<p>Clair utilizes go packages we call “updaters” that encapsulate the logic of
fetching and parsing different vulnerability databases. Updaters are usually
pared with a matcher to interpret if and how any vulnerability is related to a
package.</p>
<p>Operators may wish to update the vulnerability database less frequently or not
import vulnerabilities from databases that they know will not be used.</p>
<h3 id="configuration-2"><a class="header" href="#configuration-2">Configuration</a></h3>
<p>Updaters can be configured by <code>updaters</code> key at the top of the configuration. If
updaters are being run automatically within the matcher processes, as is the
default, the period for running updaters is configured under the matcher’s
configuration stanza.</p>
<h4 id="choosing-sets"><a class="header" href="#choosing-sets">Choosing Sets</a></h4>
<p>Specific sets of updaters can be selected by the <code>sets</code> list. If not present,
the defaults of all upstream updaters will be used.</p>
<pre><code class="language-yaml">updaters:
  sets:
    - rhel
</code></pre>
<h4 id="specific-updaters"><a class="header" href="#specific-updaters">Specific Updaters</a></h4>
<p>Configuration for specific updaters can be passed by putting a key underneath
the <code>config</code> member of the <code>updaters</code> object. The name of an updater may be
constructed dynamically; users should examine logs to double-check names.
The specific object that an updater expects should be covered in the updater’s
documentation.</p>
<p>For example, to have the “rhel” updater fetch a manifest from a different
location:</p>
<pre><code class="language-yaml">updaters:
  config:
    rhel:
      url: https://example.com/mirror/oval/PULP_MANIFEST
</code></pre>
<h3 id="airgap"><a class="header" href="#airgap">Airgap</a></h3>
<p>For additional flexibility, Clair supports running updaters in a different
environment and importing the results. This is aimed at supporting installations
that disallow the Clair cluster from talking to the Internet directly. An update
procedure needs to arrange to call the relevant <code>clairctl</code> command in an
environment with access to the Internet, move the resulting artifact across the
airgap according to site policy, and then call the relevant <code>clairctl</code> command
to import the updates.</p>
<p>For example:</p>
<pre><code class="language-sh"># On a workstation, run:
clairctl export-updaters updates.json.gz
</code></pre>
<pre><code class="language-sh"># Move the resulting file to a place reachable by the cluster:
scp updates.json.gz internal-webserver:/var/www/
</code></pre>
<pre><code class="language-sh"># On a pod inside the cluster, import the file:
clairctl import-updaters http://web.svc/updates.json.gz
</code></pre>
<p>Note that a configuration file is needed to run these commands.</p>
<h4 id="configuration-1-1"><a class="header" href="#configuration-1-1">Configuration</a></h4>
<p>Matcher processes should have the <code>disable_updaters</code> key set to disable
automatic updaters running.</p>
<pre><code class="language-yaml">matcher:
  disable_updaters: true
</code></pre>
<h2 id="indexers"><a class="header" href="#indexers">Indexers</a></h2>
<h3 id="configuration-2-1"><a class="header" href="#configuration-2-1">Configuration</a></h3>
<h4 id="airgap-1"><a class="header" href="#airgap-1">Airgap</a></h4>
<pre><code class="language-yaml">indexer:
  airgap: true
</code></pre>
<h4 id="specific-scanners"><a class="header" href="#specific-scanners">Specific Scanners</a></h4>
<pre><code class="language-yaml">indexer:
  scanner:
    package:
      name:
        key: value
    repo:
      name:
        key: value
    dist:
      name:
        key: value
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="operation"><a class="header" href="#operation">Operation</a></h1>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="contribuion"><a class="header" href="#contribuion">Contribuion</a></h1>
<p>The following sections provides information on how to contribute to Clair.</p>
<ul>
<li><a href="#building">Building</a></li>
<li><a href="#commit-style">Commit Style</a></li>
<li><a href="#releases-1">Releases</a></li>
<li><a href="#openapi">OpenAPI</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="building"><a class="header" href="#building">Building</a></h1>
<p>This repo is intended to be built with familiar <code>go build</code> or <code>go install</code> invocations.
All binaries (excepting debugging tools) are underneath the <code>cmd</code> directory.</p>
<h3 id="cross-compiling"><a class="header" href="#cross-compiling">Cross-compiling</a></h3>
<p>Currently Clair does not have any cgo dependencies, so there should not be any cross-compilation concerns.</p>
<h2 id="container"><a class="header" href="#container">Container</a></h2>
<p>A <code>Dockerfile</code> for the project is in the repo root.
<strong>The only upstream-supported means of using it is Buildkit via <code>buildctl</code>.</strong>
See the <code>container</code>, <code>container-build</code>, <code>dist-container</code>, and <code>dist-clairctl</code> make targets for example invocations.
The <code>BUILDKIT_HOST</code> environment variable may need to be set, depending on how <code>buildkitd</code> is running in one’s environment.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="commit-style"><a class="header" href="#commit-style">Commit Style</a></h1>
<p>The Clair project utilizes well structured commits to keep the history useful and help with release automation.
We suggest signing off on your commits as well.</p>
<p>A typical commit will take on the following structure:</p>
<pre><code>&lt;scope&gt;: &lt;subject&gt;

&lt;body&gt;
Fixes #1
Pull Request #2

Signed-Off By: &lt;email&gt;
</code></pre>
<p>The header of the commit is regexp checked before commit and your commit will be kicked back if it does not conform.</p>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>This is the section of code this commit influences.</p>
<p>You will often see scopes such as “notifier”, “auth”, “chore”, “cicd”.</p>
<p>We use this field to group commits by scope in our automated changelog generation.</p>
<p>It would be wise to take a look at our changelog before contributing to get an idea of the common scopes we use.</p>
<h2 id="subject"><a class="header" href="#subject">Subject</a></h2>
<p>Subject is a short and concise summary of the change the commit is introducing. It should be a sentence fragment without starting capitalization and ending punctuation and limited to about 60 characters, to allow for the scope prefix and decoration in the git log.</p>
<h2 id="body"><a class="header" href="#body">Body</a></h2>
<p>Body should be full of detail.</p>
<p>Explain what this commit is doing and why it is necessary.</p>
<p>You may include references to issues and pull requests as well. Our automated changelog process will discover references prefixed with “Fixes”, “Closed” and “Pull Request”</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="releases-1"><a class="header" href="#releases-1">Releases</a></h1>
<p>Clair releases are cut roughly every three months and actively maintained for
six.</p>
<p>This means that bugfixes should be landed on <code>master</code> (if applicable) and then
marked for backporting to a minor version’s release branch. The process for
doing this is not yet formalized.</p>
<h2 id="process"><a class="header" href="#process">Process</a></h2>
<h3 id="minor"><a class="header" href="#minor">Minor</a></h3>
<p>When cutting a new minor release, two things need to be done: creating a tag and
creating a release branch. This can be done like so:</p>
<pre><code class="language-sh">git tag -as v4.x.0 HEAD
git push upstream HEAD:release-4.x tag v4.x.0
</code></pre>
<p>Then, a “release” needs to be created in the Github UI using the created tag.</p>
<h3 id="patch"><a class="header" href="#patch">Patch</a></h3>
<p>A patch release is just like a minor release with the caveat that minor version
tags should <em>only</em> appear on release branches and a new branch does not need to
be created.</p>
<pre><code class="language-sh">git checkout release-4.x
git tag -as v4.x.1 HEAD
git push upstream tag v4.x.1
</code></pre>
<p>Then, a “release” needs to be created in the Github UI using the created tag.</p>
<h3 id="creating-artifacts"><a class="header" href="#creating-artifacts">Creating Artifacts</a></h3>
<p>Clair’s artifact release process is automated and driven off the releases in
Github.</p>
<p>Publishing a new release in the Github UI automatically triggers the creation of
a complete source archive and a container. The archive is attached to the
release, and the container is pushed to the
<a href="https://quay.io/repository/projectquay/clair"><code>quay.io/projectquay/clair</code></a>
repository.</p>
<p>This is all powered by a Github Action in <code>.github/workflows/cut-release.yml</code>.</p>
<p>A complete source archive can be created with <code>make dist</code>.
A corresponding container can be created with <code>make dist-container</code>.
See <code>etc/config.mk</code> for documentation on variables that control these targets.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="openapi"><a class="header" href="#openapi">OpenAPI</a></h1>
<p>The <a href="https://spec.openapis.org/oas/v3.1.0.html">OpenAPI specification</a> has moved from <code>openapi.yaml</code> to the <code>openapi.json</code>
and <code>openapi.yaml</code> files in <code>httptransport/api/v1</code>.</p>
<p>These files are autogenerated from files in <code>httptransport/api</code> and
<code>httptransport/types</code> via the <code>httptransport/api/openapi.zsh</code> script. This
script requires <code>zsh</code> to run and <code>sha256sum</code>, <code>git</code>, <code>jq</code>, <code>yq</code>, and <code>npx</code>
commands in <code>PATH</code>.</p>
<h2 id="modifications"><a class="header" href="#modifications">Modifications</a></h2>
<p>To modify the OpenAPI spec, edit the relevant <code>httptransport/api/*/openapi.jq</code>
file (a <a href="https://jqlang.org/manual/"><code>jq</code></a> script) or the <code>httptransport/api/lib/oapi.jq</code> library as needed,
then run <code>go generate ./httptransport</code>.</p>
<p>The <code>go generate</code> command also needs to be run if files in <code>httptransport/types</code>
are modified.</p>
<h2 id="script"><a class="header" href="#script">Script</a></h2>
<p>The <code>openapi.zsh</code> script works by:</p>
<ul>
<li>for each <code>v*</code> directory under <code>httptransport/api</code>:
<ul>
<li>for all <a href="https://json-schema.org/">JSON Schema</a> files in the corresponding <code>httptransport/types/v*</code> directory:
<ul>
<li>lint the schema</li>
<li>slip-steam examples from the corresponding <code>examples</code> file</li>
</ul>
</li>
<li>amalgamate all the files from the previous step</li>
<li>run the <code>openapi.jq</code> script with <code>null</code> input</li>
<li>merge the outputs of the previous two steps</li>
<li><del>validate and lint the OpenAPI spec</del><sup class="footnote-reference" id="fr-note-1"><a href="#footnote-note">1</a></sup></li>
<li>generate a <code>yaml</code> representation</li>
<li>write out a <code>sha256</code> checksum in <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/ETag">Etag</a> format</li>
</ul>
</li>
</ul>
<hr>
<ol class="footnote-definition">
<li id="footnote-note">
<p>The OpenAPI spec <em>should</em> also be validated or linted, but there’s not a known tool that handles JSON Schema <a href="https://www.learnjsonschema.com/2020-12/core/ref/">reference resolution</a> correctly. <a href="#fr-note-1">↩</a></p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="reference"><a class="header" href="#reference">Reference</a></h1>
<p>The following sections provide reference information useful when exploring the documentation or working with Clair directly.</p>
<ul>
<li><a href="#clair-container-analyzer">API</a></li>
<li><a href="#clairctl">Clairctl</a></li>
<li><a href="#config">Config</a></li>
<li><a href="#indexer-1">Indexer</a></li>
<li><a href="#matcher-1">Matcher</a></li>
<li><a href="#notifier-1">Notifier</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<hr>
<p>title: Clair Container Analyzer v1.2.0
language_tabs:</p>
<ul>
<li>python: Python</li>
<li>go: Golang</li>
<li>javascript: Javascript
language_clients:</li>
<li>python: “”</li>
<li>go: “”</li>
<li>javascript: “”
toc_footers:</li>
<li><a href="https://quay.github.io/clair/">External documentation</a>
includes: []
search: false
highlight_theme: darkula
headingLevel: 2</li>
</ul>
<hr><!-- Generator: Widdershins v4.0.1 -->
<h1 id="clair-container-analyzer">Clair Container Analyzer v1.2.0</h1>

<blockquote>
<p>Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.</p>
</blockquote>
<p>Clair is a set of cooperating microservices which can index and match a container image’s content with known vulnerabilities.</p>
<p><strong>Note:</strong> Any endpoints tagged “internal” are documented for completeness but are considered exempt from versioning.</p>
<p>Email: <a href="mailto:clair-devel@googlegroups.com">Clair Team</a> Web: <a href="http://github.com/quay/clair">Clair Team</a>
License: <a href="http://www.apache.org/licenses/">Apache License 2.0</a></p>
<h1 id="authentication-1"><a class="header" href="#authentication-1">Authentication</a></h1>
<ul>
<li>HTTP Authentication, scheme: bearer Clair’s authentication scheme.</li>
</ul>
<p>This is a <a href="https://datatracker.ietf.org/doc/html/rfc7519">JWT</a> signed with a configured pre-shared key containing an allowlisted <code>iss</code> claim.</p>
<h1 id="clair-container-analyzer-indexer">indexer</h1>

<p>Indexer service endpoints.</p>
<p>These are responsible for determining the contents of containers.</p>
<h2 id="index-a-manifest"><a class="header" href="#index-a-manifest">Index a Manifest</a></h2>
<p><a id="opIdIndex"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/vnd.clair.manifest.v1+json',
  'Accept': 'application/vnd.clair.index_report.v1+json'
}

r = requests.post('/indexer/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/vnd.clair.manifest.v1+json"},
        "Accept": []string{"application/vnd.clair.index_report.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("POST", "/indexer/api/v1/index_report", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "Authoriztion": [
          "Bearer hunter2"
        ]
      }
    }
  ]
}';
const headers = {
  'Content-Type':'application/vnd.clair.manifest.v1+json',
  'Accept':'application/vnd.clair.index_report.v1+json'
};

fetch('/indexer/api/v1/index_report',
{
  method: 'POST',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>POST /indexer/api/v1/index_report</code></p>
<p>By submitting a Manifest object to this endpoint Clair will fetch the layers, scan each layer’s contents, and provide an index of discovered packages, repository and distribution information.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "Authoriztion": [
          "Bearer hunter2"
        ]
      }
    }
  ]
}
</code></pre>
<h3 id="index-a-manifest-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>body</td><td>body</td><td><a href="#schemamanifest">manifest</a></td><td>true</td><td>Manifest to index.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": null,
  "state": "string",
  "err": "string",
  "success": true,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  }
}
</code></pre>
<h3 id="index-a-manifest-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>IndexReport created.</td><td></td></tr>
</tbody>
</table>
</div>
<p>Clients may want to avoid reading the body if simply submitting the manifest for later vulnerability reporting.|<a href="#schemaindex_report">index_report</a>|
|400|<a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a>|Bad Request|<a href="#schemaerror">error</a>|
|412|<a href="https://tools.ietf.org/html/rfc7232#section-4.2">Precondition Failed</a>|Precondition Failed|None|
|415|<a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a>|Unsupported Media Type|<a href="#schemaerror">error</a>|
|default|Default|Internal Server Error|<a href="#schemaerror">error</a>|</p>
<h3 id="response-headers"><a class="header" href="#response-headers">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>201</td><td>Location</td><td>string</td><td></td><td>HTTP <a href="https://httpwg.org/specs/rfc9110.html#field.location">Location header</a></td></tr>
<tr><td>201</td><td>Link</td><td>string</td><td></td><td>Web Linking <a href="https://httpwg.org/specs/rfc8288.html#header">Link header</a></td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="delete-indexed-manifests"><a class="header" href="#delete-indexed-manifests">Delete Indexed Manifests</a></h2>
<p><a id="opIdDeleteManifests"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/vnd.clair.bulk_delete.v1+json',
  'Accept': 'application/vnd.clair.bulk_delete.v1+json'
}

r = requests.delete('/indexer/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/vnd.clair.bulk_delete.v1+json"},
        "Accept": []string{"application/vnd.clair.bulk_delete.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/indexer/api/v1/index_report", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]';
const headers = {
  'Content-Type':'application/vnd.clair.bulk_delete.v1+json',
  'Accept':'application/vnd.clair.bulk_delete.v1+json'
};

fetch('/indexer/api/v1/index_report',
{
  method: 'DELETE',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /indexer/api/v1/index_report</code></p>
<p>Given a Manifest’s content addressable hash, any data related to it will be removed if it exists.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]
</code></pre>
<h3 id="delete-indexed-manifests-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>body</td><td>body</td><td><a href="#schemabulk_delete">bulk_delete</a></td><td>true</td><td>Array of manifest digests to delete.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]
</code></pre>
<h3 id="delete-indexed-manifests-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Successfully deleted manifests.</td><td><a href="#schemabulk_delete">bulk_delete</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-1"><a class="header" href="#response-headers-1">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="delete-an-indexed-manifest"><a class="header" href="#delete-an-indexed-manifest">Delete an Indexed Manifest</a></h2>
<p><a id="opIdDeleteManifest"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.error.v1+json'
}

r = requests.delete('/indexer/api/v1/index_report/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.error.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/indexer/api/v1/index_report/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.error.v1+json'
};

fetch('/indexer/api/v1/index_report/{digest}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /indexer/api/v1/index_report/{digest}</code></p>
<p>Given a Manifest’s content addressable hash, any data related to it will be removed it it exists.</p>
<h3 id="delete-an-indexed-manifest-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-an-indexed-manifest-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>204</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.5">No Content</a></td><td>Success</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-the-indexreport-for-a-manifest"><a class="header" href="#retrieve-the-indexreport-for-a-manifest">Retrieve the IndexReport for a Manifest</a></h2>
<p><a id="opIdGetIndexReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.index_report.v1+json'
}

r = requests.get('/indexer/api/v1/index_report/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.index_report.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/indexer/api/v1/index_report/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.index_report.v1+json'
};

fetch('/indexer/api/v1/index_report/{digest}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /indexer/api/v1/index_report/{digest}</code></p>
<p>Given a Manifest’s content addressable hash, an IndexReport will be retrieved if it exists.</p>
<h3 id="retrieve-the-indexreport-for-a-manifest-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": null,
  "state": "string",
  "err": "string",
  "success": true,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  }
}
</code></pre>
<h3 id="retrieve-the-indexreport-for-a-manifest-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>IndexReport retrieved</td><td><a href="#schemaindex_report">index_report</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-2"><a class="header" href="#response-headers-2">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="report-the-indexers-state"><a class="header" href="#report-the-indexers-state">Report the Indexer’s State</a></h2>
<p><a id="opIdIndexState"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.index_state.v1+json'
}

r = requests.get('/indexer/api/v1/index_state', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.index_state.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/indexer/api/v1/index_state", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.index_state.v1+json'
};

fetch('/indexer/api/v1/index_state',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /indexer/api/v1/index_state</code></p>
<p>The index state endpoint returns a json structure indicating the indexer’s internal configuration state.
A client may be interested in this as a signal that manifests may need to be re-indexed.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "state": "string"
}
</code></pre>
<h3 id="report-the-indexer&#39;s-state-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Indexer State</td><td><a href="#schemaindex_state">index_state</a></td></tr>
<tr><td>304</td><td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">Not Modified</a></td><td>Not Modified</td><td>None</td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-3"><a class="header" href="#response-headers-3">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Etag</td><td>string</td><td></td><td>HTTP <a href="https://httpwg.org/specs/rfc9110.html#field.etag">ETag header</a></td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="clair-container-analyzer-matcher">matcher</h1>

<p>Matcher service endpoints.</p>
<p>These are responsible for generating reports against current vulnerability data.</p>
<h2 id="retrieve-a-vulnerabilityreport-for-a-manifest"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-manifest">Retrieve a VulnerabilityReport for a Manifest</a></h2>
<p><a id="opIdGetVulnerabilityReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.vulnerability_report.v1+json'
}

r = requests.get('/matcher/api/v1/vulnerability_report/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.vulnerability_report.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/vulnerability_report/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.vulnerability_report.v1+json'
};

fetch('/matcher/api/v1/vulnerability_report/{digest}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/vulnerability_report/{digest}</code></p>
<p>Given a Manifest’s content addressable hash a VulnerabilityReport will be created. The Manifest <strong>must</strong> have been Indexed first via the Index endpoint.</p>
<h3 id="retrieve-a-vulnerabilityreport-for-a-manifest-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": null,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  },
  "vulnerabilities": {},
  "package_vulnerabilities": {
    "property1": [
      "string"
    ],
    "property2": [
      "string"
    ]
  },
  "enrichments": {
    "property1": [],
    "property2": []
  }
}
</code></pre>
<h3 id="retrieve-a-vulnerabilityreport-for-a-manifest-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>Vulnerability Report Created</td><td><a href="#schemavulnerability_report">vulnerability_report</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="clair-container-analyzer-notifier">notifier</h1>

<p>Matcher service endpoints.</p>
<p>These are responsible for serving notifications.</p>
<h2 id="delete-a-notification-set"><a class="header" href="#delete-a-notification-set">Delete a Notification Set</a></h2>
<p><a id="opIdDeleteNotification"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.error.v1+json'
}

r = requests.delete('/notifier/api/v1/notification/{id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.error.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/notifier/api/v1/notification/{id}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.error.v1+json'
};

fetch('/notifier/api/v1/notification/{id}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /notifier/api/v1/notification/{id}</code></p>
<p>Issues a delete of the provided notification ID and all associated notifications.
After this delete clients will no longer be able to retrieve notifications.</p>
<h3 id="delete-a-notification-set-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id</td><td>path</td><td><a href="#schematoken">token</a></td><td>true</td><td>A notification ID returned by a callback</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-a-notification-set-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Delete the notification referenced by the “id” parameter.</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-4"><a class="header" href="#response-headers-4">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-pages-of-a-notification-set"><a class="header" href="#retrieve-pages-of-a-notification-set">Retrieve Pages of a Notification Set</a></h2>
<p><a id="opIdGetNotification"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.notification_page.v1+json'
}

r = requests.get('/notifier/api/v1/notification/{id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.notification_page.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/notifier/api/v1/notification/{id}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.notification_page.v1+json'
};

fetch('/notifier/api/v1/notification/{id}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /notifier/api/v1/notification/{id}</code></p>
<p>By performing a GET with an id as a path parameter, the client will retrieve a paginated response of notification objects.</p>
<h3 id="retrieve-pages-of-a-notification-set-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>page_size</td><td>query</td><td>integer</td><td>false</td><td>The maximum number of notifications to deliver in a single page.</td></tr>
<tr><td>next</td><td>query</td><td><a href="#schematoken">token</a></td><td>false</td><td>The next page to fetch via id. Typically this number is provided on initial response in the “page.next” field. The first request should omit this field.</td></tr>
<tr><td>id</td><td>path</td><td><a href="#schematoken">token</a></td><td>true</td><td>A notification ID returned by a callback</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "page": {
    "size": 100,
    "next": "1b4d0db2-e757-4150-bbbb-543658144205"
  },
  "notifications": [
    {
      "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
      "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
      "reason": "added",
      "vulnerability": {
        "name": "CVE-2009-5155",
        "fixed_in_version": "v0.0.1",
        "links": "http://example.com/CVE-2009-5155",
        "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
        "normalized_severity": "Unknown",
        "package": {
          "id": "10",
          "name": "libapt-pkg5.0",
          "version": "1.6.11",
          "kind": "BINARY",
          "arch": "x86",
          "source": {
            "id": "9",
            "name": "apt",
            "version": "1.6.11",
            "kind": "SOURCE",
            "source": null
          }
        },
        "distribution": {
          "id": "1",
          "did": "ubuntu",
          "name": "Ubuntu",
          "version": "18.04.3 LTS (Bionic Beaver)",
          "version_code_name": "bionic",
          "version_id": "18.04",
          "pretty_name": "Ubuntu 18.04.3 LTS"
        }
      }
    }
  ]
}
</code></pre>
<h3 id="retrieve-pages-of-a-notification-set-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>A paginated list of notifications</td><td><a href="#schemanotification_page">notification_page</a></td></tr>
<tr><td>304</td><td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">Not Modified</a></td><td>Not Modified</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-5"><a class="header" href="#response-headers-5">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="clair-container-analyzer-internal">internal</h1>

<p>These are internal endpoints, documented for completeness.</p>
<p>They are exempted from API stability guarentees.</p>
<h2 id="retrieve-manifests-affected-by-a-vulnerability"><a class="header" href="#retrieve-manifests-affected-by-a-vulnerability">Retrieve Manifests Affected by a Vulnerability</a></h2>
<p><a id="opIdAffectedManifests"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/vnd.clair.vulnerability_summaries.v1+json',
  'Accept': 'application/vnd.clair.affected_manifests.v1+json'
}

r = requests.post('/indexer/api/v1/internal/affected_manifest', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/vnd.clair.vulnerability_summaries.v1+json"},
        "Accept": []string{"application/vnd.clair.affected_manifests.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("POST", "/indexer/api/v1/internal/affected_manifest", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '[]';
const headers = {
  'Content-Type':'application/vnd.clair.vulnerability_summaries.v1+json',
  'Accept':'application/vnd.clair.affected_manifests.v1+json'
};

fetch('/indexer/api/v1/internal/affected_manifest',
{
  method: 'POST',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>POST /indexer/api/v1/internal/affected_manifest</code></p>
<p>The provided vulnerability summaries are attempted to be run “backwards” through the indexer to produce a set of manifests.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">[]
</code></pre>
<h3 id="retrieve-manifests-affected-by-a-vulnerability-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>body</td><td>body</td><td><a href="#schemavulnerability_summaries">vulnerability_summaries</a></td><td>true</td><td>Array of vulnerability summaries to report on.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "vulnerabilities": {
    "42": {
      "id": "42"
    }
  },
  "vulnerable_manifests": {
    "sha256:01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b": [
      "42"
    ]
  }
}
</code></pre>
<h3 id="retrieve-manifests-affected-by-a-vulnerability-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>The list of manifests and the corresponding vulnerabilities.</td><td><a href="#schemaaffected_manifests">affected_manifests</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-6"><a class="header" href="#response-headers-6">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-vulnerability-changes-between-two-update-operations"><a class="header" href="#retrieve-vulnerability-changes-between-two-update-operations">Retrieve Vulnerability Changes Between Two Update Operations</a></h2>
<p><a id="opIdGetUpdateDiff"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.update_diff.v1+json'
}

r = requests.get('/matcher/api/v1/internal/update_diff', params={
  'prev': 'string'
}, headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.update_diff.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/internal/update_diff", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.update_diff.v1+json'
};

fetch('/matcher/api/v1/internal/update_diff?prev=string',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/internal/update_diff</code></p>
<p>Given IDs for two Update Operations, this will return the difference between them. This is used in the notification flow.</p>
<h3 id="retrieve-vulnerability-changes-between-two-update-operations-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>cur</td><td>query</td><td><a href="#schematoken">token</a></td><td>false</td><td>“Current” Update Operation ref.</td></tr>
<tr><td>prev</td><td>query</td><td><a href="#schematoken">token</a></td><td>true</td><td>“Previous” Update Operation ref.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "prev": null,
  "cur": null,
  "added": [],
  "removed": []
}
</code></pre>
<h3 id="retrieve-vulnerability-changes-between-two-update-operations-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Changes between two Update Operations.</td><td><a href="#schemaupdate_diff">update_diff</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-7"><a class="header" href="#response-headers-7">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-update-operations"><a class="header" href="#retrieve-update-operations">Retrieve Update Operations</a></h2>
<p><a id="opIdGetUpdateOperation"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.update_operations.v1+json'
}

r = requests.get('/matcher/api/v1/internal/update_operation', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.update_operations.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/internal/update_operation", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.update_operations.v1+json'
};

fetch('/matcher/api/v1/internal/update_operation',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/internal/update_operation</code></p>
<p>Retrive all known or just the latest Update Operations.</p>
<h3 id="retrieve-update-operations-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>kind</td><td>query</td><td>any</td><td>false</td><td>The “kind” of updaters to query.</td></tr>
<tr><td>latest</td><td>query</td><td>boolean</td><td>false</td><td>Return only the latest Update Operations instead of all known Update Operations.</td></tr>
</tbody>
</table>
</div>
<h4 id="enumerated-values"><a class="header" href="#enumerated-values">Enumerated Values</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Parameter</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td>kind</td><td>vulnerability</td></tr>
<tr><td>kind</td><td>enrichment</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "property1": [],
  "property2": []
}
</code></pre>
<h3 id="retrieve-update-operations-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Update Operations, keyed by updater.</td><td><a href="#schemaupdate_operations">update_operations</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-8"><a class="header" href="#response-headers-8">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="delete-an-update-operation"><a class="header" href="#delete-an-update-operation">Delete an Update Operation</a></h2>
<p><a id="opIdDeleteUpdateOperation"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.error.v1+json'
}

r = requests.delete('/matcher/api/v1/internal/update_operation/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.error.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/matcher/api/v1/internal/update_operation/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.error.v1+json'
};

fetch('/matcher/api/v1/internal/update_operation/{digest}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /matcher/api/v1/internal/update_operation/{digest}</code></p>
<p>Issues a delete of the provided Update Operation ID and all associated data.
After this delete clients will no longer be able to generate a diff against this Update Operation.</p>
<h3 id="delete-an-update-operation-parameters">Parameters</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody>
</table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-an-update-operation-responses">Responses</h3>

<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr>
</thead>
<tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Success</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody>
</table>
</div>
<h3 id="response-headers-9"><a class="header" href="#response-headers-9">Response Headers</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody>
</table>
</div>
<aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="schemas"><a class="header" href="#schemas">Schemas</a></h1>
<h2 id="tocS_token">token</h2>

<!-- backwards compatibility -->
<a id="schematoken"></a>
<a id="schema_token"></a>
<a id="tocStoken"></a>
<a id="tocstoken"></a>
<pre><code class="language-json">"string"

</code></pre>
<p>An opaque token previously obtained from the service.</p>
<h3 id="properties"><a class="header" href="#properties">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>An opaque token previously obtained from the service.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_affected_manifests">affected_manifests</h2>

<!-- backwards compatibility -->
<a id="schemaaffected_manifests"></a>
<a id="schema_affected_manifests"></a>
<a id="tocSaffected_manifests"></a>
<a id="tocsaffected_manifests"></a>
<pre><code class="language-json">{
  "vulnerabilities": {
    "42": {
      "id": "42"
    }
  },
  "vulnerable_manifests": {
    "sha256:01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b": [
      "42"
    ]
  }
}

</code></pre>
<p>Affected Manifests</p>
<h3 id="properties-1"><a class="header" href="#properties-1">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>Vulnerability objects.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemavulnerability.schema.json">vulnerability.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>vulnerable_manifests</td><td>object</td><td>true</td><td>none</td><td>Mapping of manifest digests to vulnerability identifiers.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_bulk_delete">bulk_delete</h2>

<!-- backwards compatibility -->
<a id="schemabulk_delete"></a>
<a id="schema_bulk_delete"></a>
<a id="tocSbulk_delete"></a>
<a id="tocsbulk_delete"></a>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]

</code></pre>
<p>Bulk Delete</p>
<h3 id="properties-2"><a class="header" href="#properties-2">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Bulk Delete</td><td>[<a href="#schemadigest.schema.json">digest.schema.json</a>]</td><td>false</td><td>none</td><td>Array of manifest digests to delete from the system.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_cpe">cpe</h2>

<!-- backwards compatibility -->
<a id="schemacpe"></a>
<a id="schema_cpe"></a>
<a id="tocScpe"></a>
<a id="tocscpe"></a>
<pre><code class="language-json">"cpe:/a:microsoft:internet_explorer:8.0.6001:beta"

</code></pre>
<p>Common Platform Enumeration Name</p>
<h3 id="properties-3"><a class="header" href="#properties-3">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Common Platform Enumeration Name</td><td>any</td><td>false</td><td>none</td><td>This is a CPE Name in either v2.2 “URI” form or v2.3 “Formatted String” form.</td></tr>
</tbody>
</table>
</div>
<p>oneOf</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>This is the CPE 2.2 regexp: https://cpe.mitre.org/specification/2.2/cpe-language_2.2.xsd</td></tr>
</tbody>
</table>
</div>
<p>xor</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>This is the CPE 2.3 regexp: https://csrc.nist.gov/schema/cpe/2.3/cpe-naming_2.3.xsd</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_digest">digest</h2>

<!-- backwards compatibility -->
<a id="schemadigest"></a>
<a id="schema_digest"></a>
<a id="tocSdigest"></a>
<a id="tocsdigest"></a>
<pre><code class="language-json">"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a"

</code></pre>
<p>Digest</p>
<h3 id="properties-4"><a class="header" href="#properties-4">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Digest</td><td>string</td><td>false</td><td>none</td><td>A digest acts as a content identifier, enabling content addressability.</td></tr>
</tbody>
</table>
</div>
<p>anyOf</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>SHA256</td></tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>SHA512</td></tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>BLAKE3<br><br><strong>Currently not implemented.</strong></td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_distribution">distribution</h2>

<!-- backwards compatibility -->
<a id="schemadistribution"></a>
<a id="schema_distribution"></a>
<a id="tocSdistribution"></a>
<a id="tocsdistribution"></a>
<pre><code class="language-json">{
  "id": "1",
  "did": "ubuntu",
  "name": "Ubuntu",
  "version": "18.04.3 LTS (Bionic Beaver)",
  "version_code_name": "bionic",
  "version_id": "18.04",
  "pretty_name": "Ubuntu 18.04.3 LTS"
}

</code></pre>
<p>Distribution</p>
<h3 id="properties-5"><a class="header" href="#properties-5">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>Unique ID for this Distribution. May be unique to the response document, not the whole system.</td></tr>
<tr><td>did</td><td>string</td><td>false</td><td>none</td><td>A lower-case string (no spaces or other characters outside of 0–9, a–z, “.”, “_”, and “-”) identifying the operating system, excluding any version information and suitable for processing by scripts or usage in generated filenames.</td></tr>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>A string identifying the operating system.</td></tr>
<tr><td>version</td><td>string</td><td>false</td><td>none</td><td>A string identifying the operating system version, excluding any OS name information, possibly including a release code name, and suitable for presentation to the user.</td></tr>
<tr><td>version_code_name</td><td>string</td><td>false</td><td>none</td><td>A lower-case string (no spaces or other characters outside of 0–9, a–z, “.”, “_”, and “-”) identifying the operating system release code name, excluding any OS name information or release version, and suitable for processing by scripts or usage in generated filenames.</td></tr>
<tr><td>version_id</td><td>string</td><td>false</td><td>none</td><td>A lower-case string (mostly numeric, no spaces or other characters outside of 0–9, a–z, “.”, “_”, and “-”) identifying the operating system version, excluding any OS name information or release code name.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>A string identifying the OS architecture.</td></tr>
<tr><td>cpe</td><td><a href="#schemacpe.schema.json">cpe.schema.json</a></td><td>false</td><td>none</td><td>Common Platform Enumeration name.</td></tr>
<tr><td>pretty_name</td><td>string</td><td>false</td><td>none</td><td>A pretty operating system name in a format suitable for presentation to the user.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_environment">environment</h2>

<!-- backwards compatibility -->
<a id="schemaenvironment"></a>
<a id="schema_environment"></a>
<a id="tocSenvironment"></a>
<a id="tocsenvironment"></a>
<pre><code class="language-json">{
  "value": {
    "package_db": "var/lib/dpkg/status",
    "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
    "distribution_id": "1"
  }
}

</code></pre>
<p>Environment</p>
<h3 id="properties-6"><a class="header" href="#properties-6">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>package_db</td><td>string</td><td>false</td><td>none</td><td>The database the associated Package was discovered in.</td></tr>
<tr><td>distribution_id</td><td>string</td><td>false</td><td>none</td><td>The ID of the Distribution of the associated Package.</td></tr>
<tr><td>introduced_in</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>false</td><td>none</td><td>The Layer the associated Package was introduced in.</td></tr>
<tr><td>repository_ids</td><td>[string]</td><td>false</td><td>none</td><td>The IDs of the Repositories of the associated Package.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_error">error</h2>

<!-- backwards compatibility -->
<a id="schemaerror"></a>
<a id="schema_error"></a>
<a id="tocSerror"></a>
<a id="tocserror"></a>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}

</code></pre>
<p>Error</p>
<h3 id="properties-7"><a class="header" href="#properties-7">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>code</td><td>string</td><td>false</td><td>none</td><td>a code for this particular error</td></tr>
<tr><td>message</td><td>string</td><td>true</td><td>none</td><td>a message with further detail</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_index_report">index_report</h2>

<!-- backwards compatibility -->
<a id="schemaindex_report"></a>
<a id="schema_index_report"></a>
<a id="tocSindex_report"></a>
<a id="tocsindex_report"></a>
<pre><code class="language-json">{
  "manifest_hash": null,
  "state": "string",
  "err": "string",
  "success": true,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  }
}

</code></pre>
<p>Index Report</p>
<h3 id="properties-8"><a class="header" href="#properties-8">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>manifest_hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The Manifest’s digest.</td></tr>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>The current state of the index operation</td></tr>
<tr><td>err</td><td>string</td><td>false</td><td>none</td><td>An error message on event of unsuccessful index</td></tr>
<tr><td>success</td><td>boolean</td><td>true</td><td>none</td><td>A bool indicating succcessful index</td></tr>
<tr><td>packages</td><td>object</td><td>false</td><td>none</td><td>A map of Package objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemapackage.schema.json">package.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>distributions</td><td>object</td><td>false</td><td>none</td><td>A map of Distribution objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemadistribution.schema.json">distribution.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>repository</td><td>object</td><td>false</td><td>none</td><td>A map of Repository objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemarepository.schema.json">repository.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>environments</td><td>object</td><td>false</td><td>none</td><td>A map of Environment arrays indexed by a Package’s identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="#schemaenvironment.schema.json">environment.schema.json</a>]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_index_state">index_state</h2>

<!-- backwards compatibility -->
<a id="schemaindex_state"></a>
<a id="schema_index_state"></a>
<a id="tocSindex_state"></a>
<a id="tocsindex_state"></a>
<pre><code class="language-json">{
  "state": "string"
}

</code></pre>
<p>Index State</p>
<h3 id="properties-9"><a class="header" href="#properties-9">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>an opaque token</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_layer">layer</h2>

<!-- backwards compatibility -->
<a id="schemalayer"></a>
<a id="schema_layer"></a>
<a id="tocSlayer"></a>
<a id="tocslayer"></a>
<pre><code class="language-json">{
  "hash": null,
  "uri": "string",
  "headers": {},
  "media_type": "string"
}

</code></pre>
<p>Layer</p>
<h3 id="properties-10"><a class="header" href="#properties-10">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>Digest of the layer blob.</td></tr>
<tr><td>uri</td><td>string</td><td>true</td><td>none</td><td>A URI indicating where the layer blob can be downloaded from.</td></tr>
<tr><td>headers</td><td>object</td><td>false</td><td>none</td><td>Any additional HTTP-style headers needed for requesting layers.</td></tr>
<tr><td>» ^[a-zA-Z0-9-_]+$</td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>media_type</td><td>string</td><td>false</td><td>none</td><td>The OCI Layer media type for this layer.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_manifest">manifest</h2>

<!-- backwards compatibility -->
<a id="schemamanifest"></a>
<a id="schema_manifest"></a>
<a id="tocSmanifest"></a>
<a id="tocsmanifest"></a>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "Authoriztion": [
          "Bearer hunter2"
        ]
      }
    }
  ]
}

</code></pre>
<p>Manifest</p>
<h3 id="properties-11"><a class="header" href="#properties-11">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The OCI Image Manifest’s digest.<br><br>This is used as an identifier throughout the system. This <strong>SHOULD</strong> be the same as the OCI Image Manifest’s digest, but this is not enforced.</td></tr>
<tr><td>layers</td><td>[<a href="#schemalayer.schema.json">layer.schema.json</a>]</td><td>false</td><td>none</td><td>The OCI Layers making up the Image, in order.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_normalized_severity">normalized_severity</h2>

<!-- backwards compatibility -->
<a id="schemanormalized_severity"></a>
<a id="schema_normalized_severity"></a>
<a id="tocSnormalized_severity"></a>
<a id="tocsnormalized_severity"></a>
<pre><code class="language-json">"Unknown"

</code></pre>
<p>Normalized Severity</p>
<h3 id="properties-12"><a class="header" href="#properties-12">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Normalized Severity</td><td>any</td><td>false</td><td>none</td><td>Standardized severity values.</td></tr>
</tbody>
</table>
</div>
<h4 id="enumerated-values-1"><a class="header" href="#enumerated-values-1">Enumerated Values</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Property</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td>Normalized Severity</td><td>Unknown</td></tr>
<tr><td>Normalized Severity</td><td>Negligible</td></tr>
<tr><td>Normalized Severity</td><td>Low</td></tr>
<tr><td>Normalized Severity</td><td>Medium</td></tr>
<tr><td>Normalized Severity</td><td>High</td></tr>
<tr><td>Normalized Severity</td><td>Critical</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_notification_page">notification_page</h2>

<!-- backwards compatibility -->
<a id="schemanotification_page"></a>
<a id="schema_notification_page"></a>
<a id="tocSnotification_page"></a>
<a id="tocsnotification_page"></a>
<pre><code class="language-json">{
  "page": {
    "size": 100,
    "next": "1b4d0db2-e757-4150-bbbb-543658144205"
  },
  "notifications": [
    {
      "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
      "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
      "reason": "added",
      "vulnerability": {
        "name": "CVE-2009-5155",
        "fixed_in_version": "v0.0.1",
        "links": "http://example.com/CVE-2009-5155",
        "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
        "normalized_severity": "Unknown",
        "package": {
          "id": "10",
          "name": "libapt-pkg5.0",
          "version": "1.6.11",
          "kind": "BINARY",
          "arch": "x86",
          "source": {
            "id": "9",
            "name": "apt",
            "version": "1.6.11",
            "kind": "SOURCE",
            "source": null
          }
        },
        "distribution": {
          "id": "1",
          "did": "ubuntu",
          "name": "Ubuntu",
          "version": "18.04.3 LTS (Bionic Beaver)",
          "version_code_name": "bionic",
          "version_id": "18.04",
          "pretty_name": "Ubuntu 18.04.3 LTS"
        }
      }
    }
  ]
}

</code></pre>
<p>Notification Page</p>
<h3 id="properties-13"><a class="header" href="#properties-13">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>page</td><td>object</td><td>true</td><td>none</td><td>An object informing the client the next page to retrieve.</td></tr>
<tr><td>» size</td><td>integer</td><td>true</td><td>none</td><td>The number of notifications contained in this page.</td></tr>
<tr><td>» next</td><td>string</td><td>false</td><td>none</td><td>The identififer to pass into the “next” parameter of a future GetNotification request.<br><br>If not present, there are no additional pages.</td></tr>
<tr><td>notifications</td><td>[<a href="#schemanotification.schema.json">notification.schema.json</a>]</td><td>true</td><td>none</td><td>Notifications within this page.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_notification">notification</h2>

<!-- backwards compatibility -->
<a id="schemanotification"></a>
<a id="schema_notification"></a>
<a id="tocSnotification"></a>
<a id="tocsnotification"></a>
<pre><code class="language-json">{
  "id": "string",
  "manifest": null,
  "reason": "added",
  "vulnerability": null
}

</code></pre>
<p>Notification</p>
<h3 id="properties-14"><a class="header" href="#properties-14">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>Unique identifier for this notification.</td></tr>
<tr><td>manifest</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The digest of the manifest affected by the provided vulnerability.</td></tr>
<tr><td>reason</td><td>any</td><td>true</td><td>none</td><td>The reason for the notifcation.</td></tr>
<tr><td>vulnerability</td><td><a href="#schemavulnerability_summary.schema.json">vulnerability_summary.schema.json</a></td><td>true</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<h4 id="enumerated-values-2"><a class="header" href="#enumerated-values-2">Enumerated Values</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Property</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td>reason</td><td>added</td></tr>
<tr><td>reason</td><td>removed</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_notification_webhook">notification_webhook</h2>

<!-- backwards compatibility -->
<a id="schemanotification_webhook"></a>
<a id="schema_notification_webhook"></a>
<a id="tocSnotification_webhook"></a>
<a id="tocsnotification_webhook"></a>
<pre><code class="language-json">{
  "notification_id": "string",
  "callback": "http://example.com"
}

</code></pre>
<p>Notification Webhook</p>
<h3 id="properties-15"><a class="header" href="#properties-15">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>notification_id</td><td>string</td><td>true</td><td>none</td><td>Unique identifier for this notification.</td></tr>
<tr><td>callback</td><td>string(uri)</td><td>true</td><td>none</td><td>A URL to retrieve paginated Notification objects.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_package">package</h2>

<!-- backwards compatibility -->
<a id="schemapackage"></a>
<a id="schema_package"></a>
<a id="tocSpackage"></a>
<a id="tocspackage"></a>
<pre><code class="language-json">{
  "id": "10",
  "name": "libapt-pkg5.0",
  "version": "1.6.11",
  "kind": "binary",
  "normalized_version": "",
  "arch": "x86",
  "module": "",
  "cpe": "",
  "source": {
    "id": "9",
    "name": "apt",
    "version": "1.6.11",
    "kind": "source",
    "source": null
  }
}

</code></pre>
<p>Package</p>
<h3 id="properties-16"><a class="header" href="#properties-16">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id</td><td>string</td><td>false</td><td>none</td><td>Unique ID for this Package. May be unique to the response document, not the whole system.</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Identifier of this Package.<br><br>The uniqueness and scoping of this name depends on the packaging system.</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>Version of this Package, as reported by the packaging system.</td></tr>
<tr><td>kind</td><td>any</td><td>false</td><td>none</td><td>The “kind” of this Package.</td></tr>
<tr><td>source</td><td><a href="#schema#">#</a></td><td>false</td><td>none</td><td>Source Package that produced the current binary Package, if known.</td></tr>
<tr><td>normalized_version</td><td>string</td><td>false</td><td>none</td><td>Normalized representation of the discoverd version.<br><br>The format is not specific, but is guarenteed to be forward compatible.</td></tr>
<tr><td>module</td><td>string</td><td>false</td><td>none</td><td>An identifier for intra-Repository grouping of packages.<br><br>Likely only relevant on rpm-based systems.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>Native architecture for the Package.</td></tr>
<tr><td>cpe</td><td><a href="#schemacpe.schema.json">cpe.schema.json</a></td><td>false</td><td>none</td><td>CPE Name for the Package.</td></tr>
</tbody>
</table>
</div>
<h4 id="enumerated-values-3"><a class="header" href="#enumerated-values-3">Enumerated Values</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Property</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td>kind</td><td>BINARY</td></tr>
<tr><td>kind</td><td>SOURCE</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_range">range</h2>

<!-- backwards compatibility -->
<a id="schemarange"></a>
<a id="schema_range"></a>
<a id="tocSrange"></a>
<a id="tocsrange"></a>
<pre><code class="language-json">{
  "[": "string",
  ")": "string"
}

</code></pre>
<p>Range</p>
<h3 id="properties-17"><a class="header" href="#properties-17">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>[</td><td>string</td><td>false</td><td>none</td><td>Lower bound, inclusive.</td></tr>
<tr><td>)</td><td>string</td><td>false</td><td>none</td><td>Upper bound, exclusive.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_repository">repository</h2>

<!-- backwards compatibility -->
<a id="schemarepository"></a>
<a id="schema_repository"></a>
<a id="tocSrepository"></a>
<a id="tocsrepository"></a>
<pre><code class="language-json">{
  "id": "string",
  "name": "string",
  "key": "string",
  "uri": "http://example.com",
  "cpe": null
}

</code></pre>
<p>Repository</p>
<h3 id="properties-18"><a class="header" href="#properties-18">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>Unique ID for this Repository. May be unique to the response document, not the whole system.</td></tr>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>Human-relevant name for the Repository.</td></tr>
<tr><td>key</td><td>string</td><td>false</td><td>none</td><td>Machine-relevant name for the Repository.</td></tr>
<tr><td>uri</td><td>string(uri)</td><td>false</td><td>none</td><td>URI describing the Repository.</td></tr>
<tr><td>cpe</td><td><a href="#schemacpe.schema.json">cpe.schema.json</a></td><td>false</td><td>none</td><td>CPE name for the Repository.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_update_diff">update_diff</h2>

<!-- backwards compatibility -->
<a id="schemaupdate_diff"></a>
<a id="schema_update_diff"></a>
<a id="tocSupdate_diff"></a>
<a id="tocsupdate_diff"></a>
<pre><code class="language-json">{
  "prev": null,
  "cur": null,
  "added": [],
  "removed": []
}

</code></pre>
<p>Update Difference</p>
<h3 id="properties-19"><a class="header" href="#properties-19">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>prev</td><td><a href="#schemaupdate_operation.schema.json">update_operation.schema.json</a></td><td>false</td><td>none</td><td>The previous Update Operation.</td></tr>
<tr><td>cur</td><td><a href="#schemaupdate_operation.schema.json">update_operation.schema.json</a></td><td>true</td><td>none</td><td>The current Update Operation.</td></tr>
<tr><td>added</td><td>[<a href="#schemavulnerability.schema.json">vulnerability.schema.json</a>]</td><td>true</td><td>none</td><td>Vulnerabilities present in “cur”, but not “prev”.</td></tr>
<tr><td>removed</td><td>[<a href="#schemavulnerability.schema.json">vulnerability.schema.json</a>]</td><td>true</td><td>none</td><td>Vulnerabilities present in “prev”, but not “cur”.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_update_operation">update_operation</h2>

<!-- backwards compatibility -->
<a id="schemaupdate_operation"></a>
<a id="schema_update_operation"></a>
<a id="tocSupdate_operation"></a>
<a id="tocsupdate_operation"></a>
<pre><code class="language-json">{
  "ref": "d0fad5d6-e996-4437-8fb9-5f40bbcfd7cc",
  "updater": "string",
  "fingerprint": "string",
  "date": "2019-08-24T14:15:22Z",
  "kind": "vulnerability"
}

</code></pre>
<p>Update Operation</p>
<h3 id="properties-20"><a class="header" href="#properties-20">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>ref</td><td>string(uuid)</td><td>true</td><td>none</td><td>A unique identifier for this update operation.</td></tr>
<tr><td>updater</td><td>string</td><td>true</td><td>none</td><td>The “updater” component that was run.</td></tr>
<tr><td>fingerprint</td><td>string</td><td>true</td><td>none</td><td>The stored “fingerprint” of this run.</td></tr>
<tr><td>date</td><td>string(date-time)</td><td>true</td><td>none</td><td>When this operation was run.</td></tr>
<tr><td>kind</td><td>any</td><td>true</td><td>none</td><td>The kind of data this operation updated.</td></tr>
</tbody>
</table>
</div>
<h4 id="enumerated-values-4"><a class="header" href="#enumerated-values-4">Enumerated Values</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Property</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td>kind</td><td>vulnerability</td></tr>
<tr><td>kind</td><td>enrichment</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_update_operations">update_operations</h2>

<!-- backwards compatibility -->
<a id="schemaupdate_operations"></a>
<a id="schema_update_operations"></a>
<a id="tocSupdate_operations"></a>
<a id="tocsupdate_operations"></a>
<pre><code class="language-json">{
  "property1": [],
  "property2": []
}

</code></pre>
<p>Update Operations</p>
<h3 id="properties-21"><a class="header" href="#properties-21">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><strong>additionalProperties</strong></td><td>[<a href="#schemaupdate_operation.schema.json">update_operation.schema.json</a>]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_vulnerability_core">vulnerability_core</h2>

<!-- backwards compatibility -->
<a id="schemavulnerability_core"></a>
<a id="schema_vulnerability_core"></a>
<a id="tocSvulnerability_core"></a>
<a id="tocsvulnerability_core"></a>
<pre><code class="language-json">{
  "name": "string",
  "fixed_in_version": "string",
  "severity": "string",
  "normalized_severity": null,
  "range": null,
  "arch_op": "equals",
  "package": null,
  "distribution": null,
  "repository": null
}

</code></pre>
<p>Vulnerability Core</p>
<h3 id="properties-22"><a class="header" href="#properties-22">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Human-readable name, as presented in the vendor data.</td></tr>
<tr><td>fixed_in_version</td><td>string</td><td>false</td><td>none</td><td>Version string, as presented in the vendor data.</td></tr>
<tr><td>severity</td><td>string</td><td>false</td><td>none</td><td>Severity, as presented in the vendor data.</td></tr>
<tr><td>normalized_severity</td><td><a href="#schemanormalized_severity.schema.json">normalized_severity.schema.json</a></td><td>true</td><td>none</td><td>A well defined set of severity strings guaranteed to be present.</td></tr>
<tr><td>range</td><td><a href="#schemarange.schema.json">range.schema.json</a></td><td>false</td><td>none</td><td>Range of versions the vulnerability applies to.</td></tr>
<tr><td>arch_op</td><td>any</td><td>false</td><td>none</td><td>Flag indicating how the referenced package’s “arch” member should be interpreted.</td></tr>
<tr><td>package</td><td><a href="#schemapackage.schema.json">package.schema.json</a></td><td>false</td><td>none</td><td>A package description</td></tr>
<tr><td>distribution</td><td><a href="#schemadistribution.schema.json">distribution.schema.json</a></td><td>false</td><td>none</td><td>A distribution description</td></tr>
<tr><td>repository</td><td><a href="#schemarepository.schema.json">repository.schema.json</a></td><td>false</td><td>none</td><td>A repository description</td></tr>
</tbody>
</table>
</div>
<p>anyOf</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>object</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>object</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<p>or</p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td><em>anonymous</em></td><td>object</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<h4 id="enumerated-values-5"><a class="header" href="#enumerated-values-5">Enumerated Values</a></h4>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Property</th><th>Value</th></tr>
</thead>
<tbody>
<tr><td>arch_op</td><td>equals</td></tr>
<tr><td>arch_op</td><td>not equals</td></tr>
<tr><td>arch_op</td><td>pattern match</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_vulnerability_report">vulnerability_report</h2>

<!-- backwards compatibility -->
<a id="schemavulnerability_report"></a>
<a id="schema_vulnerability_report"></a>
<a id="tocSvulnerability_report"></a>
<a id="tocsvulnerability_report"></a>
<pre><code class="language-json">{
  "manifest_hash": null,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  },
  "vulnerabilities": {},
  "package_vulnerabilities": {
    "property1": [
      "string"
    ],
    "property2": [
      "string"
    ]
  },
  "enrichments": {
    "property1": [],
    "property2": []
  }
}

</code></pre>
<p>Vulnerability Report</p>
<h3 id="properties-23"><a class="header" href="#properties-23">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>manifest_hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The Manifest’s digest.</td></tr>
<tr><td>packages</td><td>object</td><td>true</td><td>none</td><td>A map of Package objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemapackage.schema.json">package.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>distributions</td><td>object</td><td>true</td><td>none</td><td>A map of Distribution objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemadistribution.schema.json">distribution.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>repository</td><td>object</td><td>false</td><td>none</td><td>A map of Repository objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemarepository.schema.json">repository.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>environments</td><td>object</td><td>true</td><td>none</td><td>A map of Environment arrays indexed by a Package’s identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="#schemaenvironment.schema.json">environment.schema.json</a>]</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A map of Vulnerabilities indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemavulnerability.schema.json">vulnerability.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>package_vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A mapping of Vulnerability identifier lists indexed by Package identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>enrichments</td><td>object</td><td>false</td><td>none</td><td>A mapping of extra “enrichment” data by type</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>array</td><td>false</td><td>none</td><td>none</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_vulnerability">vulnerability</h2>

<!-- backwards compatibility -->
<a id="schemavulnerability"></a>
<a id="schema_vulnerability"></a>
<a id="tocSvulnerability"></a>
<a id="tocsvulnerability"></a>
<pre><code class="language-json">false

</code></pre>
<p>Vulnerability</p>
<h3 id="properties-24"><a class="header" href="#properties-24">Properties</a></h3>
<p><em>None</em></p>
<h2 id="tocS_vulnerability_summaries">vulnerability_summaries</h2>

<!-- backwards compatibility -->
<a id="schemavulnerability_summaries"></a>
<a id="schema_vulnerability_summaries"></a>
<a id="tocSvulnerability_summaries"></a>
<a id="tocsvulnerability_summaries"></a>
<pre><code class="language-json">[]

</code></pre>
<p>Vulnerability Summaries</p>
<h3 id="properties-25"><a class="header" href="#properties-25">Properties</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>Vulnerability Summaries</td><td>[<a href="#schemavulnerability_summary.schema.json">vulnerability_summary.schema.json</a>]</td><td>false</td><td>none</td><td><strong>This is an internal type, documented for completeness.</strong><br><br>This is an array of pseudo-Vulnerability objects used for reverse-lookup.</td></tr>
</tbody>
</table>
</div>
<h2 id="tocS_vulnerability_summary">vulnerability_summary</h2>

<!-- backwards compatibility -->
<a id="schemavulnerability_summary"></a>
<a id="schema_vulnerability_summary"></a>
<a id="tocSvulnerability_summary"></a>
<a id="tocsvulnerability_summary"></a>
<pre><code class="language-json">false

</code></pre>
<p>Vulnerability Summary</p>
<h3 id="properties-26"><a class="header" href="#properties-26">Properties</a></h3>
<p><em>None</em></p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="clairctl"><a class="header" href="#clairctl">Clairctl</a></h1>
<p><code>clairctl</code> is a command line tool for working with Clair.
This CLI is capable of generating manifests from most public registries
(dockerhub, quay.io, Red Hat Container Catalog) and submitting them for
analysis to a running Clair.</p>
<p>Note that if the Clair instance has authentication configured, the value
provided to the <code>issuer</code> flag must be on the list accepted by the server.</p>
<pre><code>NAME:
   clairctl - interact with a clair API

USAGE:
   clairctl [global options] command [command options] [arguments...]

VERSION:
   0.1.0

DESCRIPTION:
   A command-line tool for clair v4.

COMMANDS:
   manifest         print a clair manifest for the named container
   report           request vulnerability reports for the named containers
   export-updaters  run updaters and export results
   import-updaters  import updates
   help, h          Shows a list of commands or help for one command

GLOBAL OPTIONS:
   -D                           print debugging logs (default: false)
   --config value, -c value     clair configuration file (default: "config.yaml") [$CLAIR_CONF]
   --issuer value, --iss value  jwt "issuer" to use when making authenticated requests (default: "clairctl")
   --help, -h                   show help (default: false)
   --version, -v                print the version (default: false)
</code></pre>
<pre><code>NAME:
   clairctl manifest - print a clair manifest for the named container

USAGE:
   clairctl manifest [arguments...]

DESCRIPTION:
   print a clair manifest for the named container
</code></pre>
<pre><code>NAME:
   clairctl report - request vulnerability reports for the named containers

USAGE:
   clairctl report [command options] container...

DESCRIPTION:
   Request and print a Clair vulnerability report for the named container(s).

OPTIONS:
   --host value           URL for the clairv4 v1 API. (default: "http://localhost:6060/") [$CLAIR_API]
   --out value, -o value  output format: text, json, xml (default: text)
</code></pre>
<pre><code>NAME:
   clairctl export-updaters - run updaters and export results

USAGE:
   clairctl export-updaters [command options] [out]

DESCRIPTION:
   Run configured exporters and export to a file.

   A configuration file is needed to run this command, see 'clairctl help'
   for how to specify one.

OPTIONS:
   --strict  Return non-zero exit when updaters report errors. (default: false)
</code></pre>
<pre><code>NAME:
   clairctl import-updaters - import updates

USAGE:
   clairctl import-updaters input...

DESCRIPTION:
   Import updates from files or HTTP URIs.

   A configuration file is needed to run this command, see 'clairctl help'
   for how to specify one.
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="config"><a class="header" href="#config">Config</a></h1>
<h2 id="cli-flags-and-environment-variables"><a class="header" href="#cli-flags-and-environment-variables">CLI Flags And Environment Variables</a></h2>
<p>Clair is configured by a structured yaml or JSON<sup class="footnote-reference" id="fr-1-1"><a href="#footnote-1">1</a></sup> file and an optional directory of “merge” and “patch” documents<sup class="footnote-reference" id="fr-1-2"><a href="#footnote-1">1</a></sup>.
Each Clair node needs to specify what mode it will run in and a path to a configuration file via CLI flags or environment variables.</p>
<p>For example:</p>
<pre><code class="language-shell">$ clair -conf ./path/to/config.yaml -mode indexer
$ clair -conf ./path/to/config.yaml -mode matcher
</code></pre>
<pre><code>-mode 
    (also specified by CLAIR_MODE env variable)
    One of the following strings
    Sets which mode the clair instances will run in
    
    "indexer": runs just the indexer node
    "matcher": runs just the matcher node
    "notifier": runs just the notifier node
    "combo": will run all services on the same node.
-conf
    (also specified by CLAIR_CONF env variable)
    A file system path to Clair's config file
</code></pre>
<p>The above example starts two Clair nodes using the same configuration.
One will only run the indexing facilities while the other will only run the matching facilities.</p>
<p>Environment variables respected by the Go standard library can be specified
if needed. Some notable examples:</p>
<ul>
<li><code>HTTP_PROXY</code></li>
<li><code>HTTPS_PROXY</code></li>
<li><code>SSL_CERT_DIR</code></li>
</ul>
<p>If running in “combo” mode you <strong>must</strong> supply the <code>indexer</code>, <code>matcher</code>,
and <code>notifier</code> configuration blocks in the configuration.</p>
<h2 id="configuration-dropins"><a class="header" href="#configuration-dropins">Configuration dropins</a></h2>
<p>Starting in Clair version <code>4.7.0</code>, dropin configuration files are supported.</p>
<p>Given a root configurtaion file of <code>/etc/clair/config.json</code>, all files matching the globs <code>/etc/clair/config.json.d/*.json</code> and <code>/etc/clair/config.json.d/*.json-patch</code> would be loaded in lexical order after the root configuration file.
Similarly, given <code>/etc/clair/config.yaml</code>, all files matching the globs <code>/etc/clair/config.yaml.d/*.yaml</code> and <code>/etc/clair/config.yaml.d/*.yaml-patch</code> would be loaded.
Only the extensions <code>yaml</code> and <code>json</code> are supported, and indicate yaml and JSON formatting, respectively.</p>
<p>The dropin files must have the same extension and format as the root file.
Dropins with the bare suffix are treated as <a href="reference/rfc7386">merge documents</a>.
Dropins with the <code>-patch</code> suffix are treated as <a href="reference/rfc6902">patch documents</a> and must contain a valid <a href="reference/rfc6902">RFC 6902</a> structure.
Yaml documents must be resolvable to the JSON subset.</p>
<p>Take care with the <a href="reference/rfc7386">merge</a> behavior around lists; a patch operation may be more suitable.
The <code>clairctl check-config</code> command can be used to ensure a merged configuration is what is intended.
In addition, placing <code>test</code> operations in a patch file that’s evaluated last (such as <code>zz-validate.json-patch</code>) can be used to have Clair refuse to start if some configuration values are not what is intended.</p>
<p>The application defaults are applied <em>after</em> the configuration is loaded and as such, not reflected in the <code>clairctl check-config</code> command.
The output of that command is also not currently suitable to be used to “compile” a config to a single file.</p>
<h2 id="deprecations-and-changes"><a class="header" href="#deprecations-and-changes">Deprecations and Changes</a></h2>
<p>Starting in version <code>4.7.0</code>, unknown keys are disallowed.
Configurations that looked valid previously and loaded fine may now cause Clair to refuse to start.</p>
<p>In version <code>4.8.0</code>, using Jaeger for trace submission was deprecated.
Configurations that use Jaeger will print a warning.
In future versions, using the Jaeger format may cause an error.</p>
<h2 id="configuration-reference"><a class="header" href="#configuration-reference">Configuration Reference</a></h2>
<p>Please see the <a href="https://pkg.go.dev/github.com/quay/clair/config">go module documentation</a> for additional documentation on defaults and use.</p>
<pre><code>http_listen_addr: ""
introspection_addr: ""
log_level: ""
tls: {}
indexer:
    connstring: ""
    scanlock_retry: 0
    layer_scan_concurrency: 0
    migrations: false
    scanner: {}
    airgap: false
matcher:
    connstring: ""
    indexer_addr: ""
    migrations: false
    period: ""
    disable_updaters: false
    update_retention: 2
matchers:
    names: nil
    config: nil
updaters:
    sets: nil
    config: nil
notifier:
    connstring: ""
    migrations: false
    indexer_addr: ""
    matcher_addr: ""
    poll_interval: ""
    delivery_interval: ""
    disable_summary: false
    webhook: null
    amqp: null
    stomp: null
auth: 
  psk: nil
trace:
    name: ""
    probability: null
    jaeger:
        agent:
            endpoint: ""
        collector:
            endpoint: ""
            username: null
            password: null
        service_name: ""
        tags: nil
        buffer_max: 0
    otlp:
	  http: {}
      grpc: {}
metrics:
    name: ""
    prometheus:
        endpoint: null
</code></pre>
<p>Note: the above just lists every key for completeness. Copy-pasting the above as
a starting point for configuration will result in some options not having their
defaults set normally.</p>
<!---
The following are purposefully omitted. See comments in the config package for
more information.

# `$.tls.root_ca`
# `$.updaters.filter`
# `$.notifier.webhook.signed`
# `$.auth.keyserver`
# `$.auth.keyserver.api`
# `$.auth.keyserver.intraservice`
# `$.trace.otlp.http.client_tls`
# `$.trace.otlp.http.client_tls.root_ca`
# `$.trace.otlp.grpc.client_tls`
# `$.trace.otlp.grpc.client_tls.root_ca`
# `$.metrics.otlp.http.client_tls`
# `$.metrics.otlp.http.client_tls.root_ca`
# `$.metrics.otlp.grpc.client_tls`
# `$.metrics.otlp.grpc.client_tls.root_ca`
-->
<h3 id="http_listen_addr"><a class="header" href="#http_listen_addr"><code>$.http_listen_addr</code></a></h3>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>This configures where the HTTP API is exposed.
See <code>/openapi/v1</code> for the API spec.</p>
<h3 id="introspection_addr"><a class="header" href="#introspection_addr"><code>$.introspection_addr</code></a></h3>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>This configures where Clair’s metrics and health endpoints are exposed.</p>
<h3 id="log_level"><a class="header" href="#log_level"><code>$.log_level</code></a></h3>
<p>Set the logging level.</p>
<p>One of the following strings:</p>
<ul>
<li>debug-color</li>
<li>debug</li>
<li>info</li>
<li>warn</li>
<li>error</li>
<li>fatal</li>
<li>panic</li>
</ul>
<h3 id="tls"><a class="header" href="#tls"><code>$.tls</code></a></h3>
<p>TLS is a map containing the config for serving the HTTP API over TLS (and
HTTP/2).</p>
<h4 id="tlscert"><a class="header" href="#tlscert"><code>$.tls.cert</code></a></h4>
<p>The TLS certificate to be used. Must be a full-chain certificate, as in nginx.</p>
<h4 id="tlskey"><a class="header" href="#tlskey"><code>$.tls.key</code></a></h4>
<p>A key file for the TLS certificate. Encryption is not supported on the key.</p>
<h3 id="indexer"><a class="header" href="#indexer"><code>$.indexer</code></a></h3>
<p>Indexer provides Clair Indexer node configuration.</p>
<h4 id="indexerairgap"><a class="header" href="#indexerairgap"><code>$.indexer.airgap</code></a></h4>
<p>Disables HTTP access to the Internet for indexers and fetchers.
Private IPv4 and IPv6 addresses are allowed.
Database connections are unaffected.</p>
<h4 id="indexerconnstring"><a class="header" href="#indexerconnstring"><code>$.indexer.connstring</code></a></h4>
<p>A Postgres connection string.</p>
<p>Accepts a format as a url (e.g.,
<code>postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full</code>)
or a libpq connection string (e.g.,
<code>user=pqgotest dbname=pqgotest sslmode=verify-full</code>).</p>
<h4 id="indexerindex_report_request_concurrency"><a class="header" href="#indexerindex_report_request_concurrency"><code>$.indexer.index_report_request_concurrency</code></a></h4>
<p>Integer.</p>
<p>Rate limits the number of index report creation requests.</p>
<p>Setting this to 0 will attempt to auto-size this value. Setting a negative value
means “unlimited.” The auto-sizing is a multiple of the number of available
cores.</p>
<p>The API will return a 429 status code if concurrency is exceeded.</p>
<h4 id="indexerscanlock_retry"><a class="header" href="#indexerscanlock_retry"><code>$.indexer.scanlock_retry</code></a></h4>
<p>A positive integer representing seconds.</p>
<p>Concurrent Indexers lock on manifest scans to avoid clobbering.
This value tunes how often a waiting Indexer will poll for the lock.</p>
<!--TODO: Move to async operating mode -->
<h4 id="indexerlayer_scan_concurrency"><a class="header" href="#indexerlayer_scan_concurrency"><code>$.indexer.layer_scan_concurrency</code></a></h4>
<p>Positive integer limiting the number of concurrent layer scans.</p>
<p>Indexers will index a Manifest’s layers concurrently.
This value tunes the number of layers an Indexer will scan in parallel.</p>
<h4 id="indexermigrations"><a class="header" href="#indexermigrations"><code>$.indexer.migrations</code></a></h4>
<p>A boolean value.</p>
<p>Whether Indexer nodes handle migrations to their database.</p>
<h4 id="indexerscanner"><a class="header" href="#indexerscanner"><code>$.indexer.scanner</code></a></h4>
<p>Indexer configurations.</p>
<p>Scanner allows for passing configuration options to layer scanners.
The scanner will have this configuration passed to it on construction if
designed to do so.</p>
<h4 id="indexerscannerdist"><a class="header" href="#indexerscannerdist"><code>$.indexer.scanner.dist</code></a></h4>
<p>A map with the name of a particular scanner and arbitrary yaml as a value.</p>
<h4 id="indexerscannerpackage"><a class="header" href="#indexerscannerpackage"><code>$.indexer.scanner.package</code></a></h4>
<p>A map with the name of a particular scanner and arbitrary yaml as a value.</p>
<h4 id="indexerscannerrepo"><a class="header" href="#indexerscannerrepo"><code>$.indexer.scanner.repo</code></a></h4>
<p>A map with the name of a particular scanner and arbitrary yaml as a value.</p>
<h3 id="matcher"><a class="header" href="#matcher"><code>$.matcher</code></a></h3>
<p>Matcher provides Clair matcher node configuration.</p>
<h4 id="matchercache_age"><a class="header" href="#matchercache_age"><code>$.matcher.cache_age</code></a></h4>
<p>Duration string.</p>
<p>Controls how long clients should be hinted to cache responses for.</p>
<h4 id="matcherconnstring"><a class="header" href="#matcherconnstring"><code>$.matcher.connstring</code></a></h4>
<p>A Postgres connection string.</p>
<p>Accepts a format as a url (e.g.,
<code>postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full</code>)
or a libpq connection string (e.g.,
<code>user=pqgotest dbname=pqgotest sslmode=verify-full</code>).</p>
<h4 id="matchermax_conn_pool"><a class="header" href="#matchermax_conn_pool"><code>$.matcher.max_conn_pool</code></a></h4>
<p>A positive integer limiting the database connection pool size.</p>
<p>Clair allows for a custom connection pool size.
This number will directly set how many active database
connections are allowed concurrently.</p>
<p>This parameter will be ignored in a future version.
Users should configure this through the connection string.</p>
<h4 id="matcherindexer_addr"><a class="header" href="#matcherindexer_addr"><code>$.matcher.indexer_addr</code></a></h4>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>A Matcher contacts an Indexer to create a VulnerabilityReport.
The location of this Indexer is required.</p>
<h4 id="matchermigrations"><a class="header" href="#matchermigrations"><code>$.matcher.migrations</code></a></h4>
<p>A boolean value.</p>
<p>Whether Matcher nodes handle migrations to their databases.</p>
<h4 id="matcherperiod"><a class="header" href="#matcherperiod"><code>$.matcher.period</code></a></h4>
<p>A time.ParseDuration parseable string.</p>
<p>Determines how often updates for new security advisories will take place.</p>
<p>Defaults to 6 hours.</p>
<h4 id="matcherdisable_updaters"><a class="header" href="#matcherdisable_updaters"><code>$.matcher.disable_updaters</code></a></h4>
<p>A boolean value.</p>
<p>Whether to run background updates or not.</p>
<h4 id="matcherdisable_enrichment"><a class="header" href="#matcherdisable_enrichment"><code>$.matcher.disable_enrichment</code></a></h4>
<p>A boolean value.</p>
<p>Whether to enrich the returned vulnerabilities or not.</p>
<h4 id="matcherupdate_retention"><a class="header" href="#matcherupdate_retention"><code>$.matcher.update_retention</code></a></h4>
<p>An integer value limiting the number of update operations kept in the database.</p>
<p>Sets the number of update operations to retain between garbage collection
cycles. This should be set to a safe MAX value based on database size
constraints.</p>
<p>Defaults to 10.</p>
<p>If a value less than 0 is provided, GC is disabled. 2 is the minimum value to
ensure updates can be compared for notifications.</p>
<h3 id="matchers"><a class="header" href="#matchers"><code>$.matchers</code></a></h3>
<p>Matchers provides configuration for the in-tree Matchers and RemoteMatchers.</p>
<h4 id="matchersnames"><a class="header" href="#matchersnames"><code>$.matchers.names</code></a></h4>
<p>A list of string values informing the matcher factory about enabled matchers.</p>
<p>If the value is nil the default list of Matchers will run:</p>
<ul>
<li>alpine-matcher</li>
<li>aws-matcher</li>
<li>debian-matcher</li>
<li>gobin</li>
<li>java-maven</li>
<li>oracle</li>
<li>photon</li>
<li>python</li>
<li>rhel</li>
<li>rhel-container-matcher</li>
<li>suse</li>
<li>ubuntu-matcher</li>
</ul>
<p>If an empty list is provided zero matchers will run.</p>
<h4 id="matchersconfig"><a class="header" href="#matchersconfig"><code>$.matchers.config</code></a></h4>
<p>Provides configuration to specific matcher.</p>
<p>A map keyed by the name of the matcher containing a sub-object which
will be provided to the matchers factory constructor.</p>
<p>A hypothetical example:</p>
<pre><code>config:
  python:
    ignore_vulns:
      - CVE-XYZ
      - CVE-ABC
</code></pre>
<h3 id="updaters-1"><a class="header" href="#updaters-1"><code>$.updaters</code></a></h3>
<p>Updaters provides configuration for the Matcher’s update manager.</p>
<h4 id="updaterssets"><a class="header" href="#updaterssets"><code>$.updaters.sets</code></a></h4>
<p>A list of string values informing the update manager which Updaters to run.</p>
<p>If the value is nil (or <code>null</code> in yaml) the default set of Updaters will run:</p>
<ul>
<li>alpine</li>
<li>aws</li>
<li>debian</li>
<li>oracle</li>
<li>osv</li>
<li>photon</li>
<li>rhcc</li>
<li>rhel</li>
<li>suse</li>
<li>ubuntu</li>
</ul>
<p>If an empty list is provided zero updaters will run.</p>
<h4 id="updatersconfig"><a class="header" href="#updatersconfig"><code>$.updaters.config</code></a></h4>
<p>Provides configuration to specific updater sets.</p>
<p>A map keyed by the name of the updater set name containing a sub-object
which will be provided to the updater set’s constructor.</p>
<p>A hypothetical example:</p>
<pre><code>config:
  ubuntu:
    security_tracker_url: http://security.url
    ignore_distributions: 
      - cosmic
</code></pre>
<h3 id="notifier"><a class="header" href="#notifier"><code>$.notifier</code></a></h3>
<p>Notifier provides Clair notifier node configuration.</p>
<h4 id="notifierconnstring"><a class="header" href="#notifierconnstring"><code>$.notifier.connstring</code></a></h4>
<p>A Postgres connection string.</p>
<p>Accepts a format as a url (e.g.,
<code>postgres://pqgotest:password@localhost/pqgotest?sslmode=verify-full</code>)
or a libpq connection string (e.g.,
<code>user=pqgotest dbname=pqgotest sslmode=verify-full</code>).</p>
<h4 id="notifiermigrations"><a class="header" href="#notifiermigrations"><code>$.notifier.migrations</code></a></h4>
<p>A boolean value.</p>
<p>Whether Notifier nodes handle migrations to their database.</p>
<h4 id="notifierindexer_addr"><a class="header" href="#notifierindexer_addr"><code>$.notifier.indexer_addr</code></a></h4>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>A Notifier contacts an Indexer to create obtain manifests affected by
vulnerabilities. The location of this Indexer is required.</p>
<h4 id="notifiermatcher_addr"><a class="header" href="#notifiermatcher_addr"><code>$.notifier.matcher_addr</code></a></h4>
<p>A string in <code>&lt;host&gt;:&lt;port&gt;</code> format where <code>&lt;host&gt;</code> can be an empty string.</p>
<p>A Notifier contacts a Matcher to list update operations and acquire diffs.
The location of this Indexer is required.</p>
<h4 id="notifierpoll_interval"><a class="header" href="#notifierpoll_interval"><code>$.notifier.poll_interval</code></a></h4>
<p>A time.ParseDuration parsable string.</p>
<p>The frequency at which the notifier will query at Matcher for Update Operations.</p>
<h4 id="notifierdelivery_interval"><a class="header" href="#notifierdelivery_interval"><code>$.notifier.delivery_interval</code></a></h4>
<p>A time.ParseDuration parsable string.</p>
<p>The frequency at which the notifier attempt delivery of created or previously
failed notifications.</p>
<h4 id="notifierdisable_summary"><a class="header" href="#notifierdisable_summary"><code>$.notifier.disable_summary</code></a></h4>
<p>A boolean.</p>
<p>Controls whether notifications should be summarized to one per manifest or not.</p>
<h4 id="notifierwebhook"><a class="header" href="#notifierwebhook"><code>$.notifier.webhook</code></a></h4>
<p>Configures the notifier for webhook delivery.</p>
<h4 id="notifierwebhooktarget"><a class="header" href="#notifierwebhooktarget"><code>$.notifier.webhook.target</code></a></h4>
<p>URL where the webhook will be delivered.</p>
<h4 id="notifierwebhookcallback"><a class="header" href="#notifierwebhookcallback"><code>$.notifier.webhook.callback</code></a></h4>
<p>The callback url where notifications can be retrieved.
The notification ID will be appended to this url.</p>
<p>This will typically be where the clair notifier is hosted.</p>
<h4 id="notifierwebhookheaders"><a class="header" href="#notifierwebhookheaders"><code>$.notifier.webhook.headers</code></a></h4>
<p>A map associating a header name to a list of values.</p>
<h4 id="notifieramqp"><a class="header" href="#notifieramqp"><code>$.notifier.amqp</code></a></h4>
<p>Configures the notifier for AMQP delivery.</p>
<p>Note: Clair does not declare any AMQP components on its own.  All attempts
to use an exchange or queue are passive only and will fail The broker
administrators should setup exchanges and queues ahead of time.</p>
<h4 id="notifieramqpdirect"><a class="header" href="#notifieramqpdirect"><code>$.notifier.amqp.direct</code></a></h4>
<p>A boolean value.</p>
<p>If true the Notifier will deliver individual notifications (not a callback)
to the configured AMQP broker.</p>
<h4 id="notifieramqprollup"><a class="header" href="#notifieramqprollup"><code>$.notifier.amqp.rollup</code></a></h4>
<p>Integer 0 or greater.</p>
<p>If <code>direct</code> is true this value will inform notifier how many notifications
to send in a single direct delivery.  For example, if <code>direct</code> is set to
<code>true</code> and <code>rollup</code> is set to <code>5</code>, the notifier will deliver no more then
5 notifications in a single json payload to the broker. Setting the value
to 0 will effectively set it to 1.</p>
<h4 id="notifieramqpexchange"><a class="header" href="#notifieramqpexchange"><code>$.notifier.amqp.exchange</code></a></h4>
<p>The AMQP Exchange to connect to.</p>
<h4 id="notifieramqpexchangename"><a class="header" href="#notifieramqpexchangename"><code>$.notifier.amqp.exchange.name</code></a></h4>
<p>string value</p>
<p>The name of the exchange to connect to.</p>
<h4 id="notifieramqpexchangetype"><a class="header" href="#notifieramqpexchangetype"><code>$.notifier.amqp.exchange.type</code></a></h4>
<p>string value</p>
<p>The type of the exchange. Typically:</p>
<ul>
<li>direct</li>
<li>fanout</li>
<li>topic</li>
<li>headers</li>
</ul>
<h4 id="notifieramqpexchangedurability"><a class="header" href="#notifieramqpexchangedurability"><code>$.notifier.amqp.exchange.durability</code></a></h4>
<p>bool value</p>
<p>Whether the configured queue is durable or not.</p>
<h4 id="notifieramqpexchangeauto_delete"><a class="header" href="#notifieramqpexchangeauto_delete"><code>$.notifier.amqp.exchange.auto_delete</code></a></h4>
<p>bool value</p>
<p>Whether the configured queue uses an auto_delete policy.</p>
<h4 id="notifieramqprouting_key"><a class="header" href="#notifieramqprouting_key"><code>$.notifier.amqp.routing_key</code></a></h4>
<p>string value</p>
<p>The name of the routing key each notification will be sent with.</p>
<h4 id="notifieramqpcallback"><a class="header" href="#notifieramqpcallback"><code>$.notifier.amqp.callback</code></a></h4>
<p>a URL string</p>
<p>If <code>direct</code> is <code>false</code>, this URL is provided in the notification callback sent
to the broker. This URL should point to Clair’s notification API endpoint.</p>
<h4 id="notifieramqpuris"><a class="header" href="#notifieramqpuris"><code>$.notifier.amqp.uris</code></a></h4>
<p>list of URL strings</p>
<p>A list of one or more AMQP brokers to connect to, in priority order.</p>
<h4 id="notifieramqptls"><a class="header" href="#notifieramqptls"><code>$.notifier.amqp.tls</code></a></h4>
<p>Configures TLS connection to AMQP broker.</p>
<h4 id="notifieramqptlsroot_ca"><a class="header" href="#notifieramqptlsroot_ca"><code>$.notifier.amqp.tls.root_ca</code></a></h4>
<p>string value</p>
<p>The filesystem path where a root CA can be read.</p>
<h4 id="notifieramqptlscert"><a class="header" href="#notifieramqptlscert"><code>$.notifier.amqp.tls.cert</code></a></h4>
<p>string value</p>
<p>The filesystem path where a tls certificate can be read. Note that clair
also respects <code>SSL_CERT_DIR</code>, as documented for the Go <code>crypto/x509</code> package.</p>
<h4 id="notifieramqptlskey"><a class="header" href="#notifieramqptlskey"><code>$.notifier.amqp.tls.key</code></a></h4>
<p>string value</p>
<p>The filesystem path where a TLS private key can be read.</p>
<h4 id="notifierstomp"><a class="header" href="#notifierstomp"><code>$.notifier.stomp</code></a></h4>
<p>Configures the notifier for STOMP delivery.</p>
<h4 id="notifierstompdirect"><a class="header" href="#notifierstompdirect"><code>$.notifier.stomp.direct</code></a></h4>
<p>A boolean value.</p>
<p>If <code>true</code>, the Notifier will deliver individual notifications (not a
callback) to the configured STOMP broker.</p>
<h4 id="notifierstomprollup"><a class="header" href="#notifierstomprollup"><code>$.notifier.stomp.rollup</code></a></h4>
<p>Integer 0 or greater.</p>
<p>If <code>direct</code> is <code>true</code>, this value will limit the number of notifications
sent in a single direct delivery.  For example, if <code>direct</code> is set to
<code>true</code> and <code>rollup</code> is set to <code>5</code>, the notifier will deliver no more
then 5 notifications in a single json payload to the broker. Setting the value
to 0 will effectively set it to 1.</p>
<h4 id="notifierstompcallback"><a class="header" href="#notifierstompcallback"><code>$.notifier.stomp.callback</code></a></h4>
<p>a URL string</p>
<p>If <code>direct</code> is <code>false</code>, this URL is provided in the notification callback sent
to the broker. This URL should point to Clair’s notification API endpoint.</p>
<h4 id="notifierstompdestination"><a class="header" href="#notifierstompdestination"><code>$.notifier.stomp.destination</code></a></h4>
<p>a string value</p>
<p>The STOMP destination to deliver notifications to.</p>
<h4 id="notifierstompuris"><a class="header" href="#notifierstompuris"><code>$.notifier.stomp.uris</code></a></h4>
<p>list of URL strings</p>
<p>A list of one or more STOMP brokers to connect to in priority order.</p>
<h4 id="notifierstomptls"><a class="header" href="#notifierstomptls"><code>$.notifier.stomp.tls</code></a></h4>
<p>Configures TLS connection to STOMP broker.</p>
<h4 id="notifierstomptlsroot_ca"><a class="header" href="#notifierstomptlsroot_ca"><code>$.notifier.stomp.tls.root_ca</code></a></h4>
<p>string value</p>
<p>The filesystem path where a root CA can be read.
Note that clair also respects <code>SSL_CERT_DIR</code>, as documented for the Go
<code>crypto/x509</code> package.</p>
<h4 id="notifierstomptlscert"><a class="header" href="#notifierstomptlscert"><code>$.notifier.stomp.tls.cert</code></a></h4>
<p>string value</p>
<p>The filesystem path where a tls certificate can be read.</p>
<h4 id="notifierstomptlskey"><a class="header" href="#notifierstomptlskey"><code>$.notifier.stomp.tls.key</code></a></h4>
<p>string value</p>
<p>The filesystem path where a tls private key can be read.</p>
<h4 id="notifierstompuser"><a class="header" href="#notifierstompuser"><code>$.notifier.stomp.user</code></a></h4>
<p>Configures login details for the STOMP broker.</p>
<h4 id="notifierstompuserlogin"><a class="header" href="#notifierstompuserlogin"><code>$.notifier.stomp.user.login</code></a></h4>
<p>string value</p>
<p>The STOMP login to connect with.</p>
<h4 id="notifierstompuserpasscode"><a class="header" href="#notifierstompuserpasscode"><code>$.notifier.stomp.user.passcode</code></a></h4>
<p>string value</p>
<p>The STOMP passcode to connect with.</p>
<h3 id="auth"><a class="header" href="#auth"><code>$.auth</code></a></h3>
<p>Defines ClairV4’s external and intra-service JWT based authentication.</p>
<p>If multiple auth mechanisms are defined, Clair will pick one. Currently, there
are not multiple mechanisms.</p>
<h3 id="authpsk"><a class="header" href="#authpsk"><code>$.auth.psk</code></a></h3>
<p>Defines preshared key authentication.</p>
<h4 id="authpskkey"><a class="header" href="#authpskkey"><code>$.auth.psk.key</code></a></h4>
<p>a string value</p>
<p>A shared base64 encoded key distributed between all parties signing and
verifying JWTs.</p>
<h4 id="authpskiss"><a class="header" href="#authpskiss"><code>$.auth.psk.iss</code></a></h4>
<p>a list of string value</p>
<p>A list of JWT issuers to verify. An empty list will accept any issuer in a
JWT claim.</p>
<h3 id="trace"><a class="header" href="#trace"><code>$.trace</code></a></h3>
<p>Defines distributed tracing configuration based on OpenTelemetry.</p>
<h4 id="tracename"><a class="header" href="#tracename"><code>$.trace.name</code></a></h4>
<p>Which submission format to use, one of:</p>
<ul>
<li>jaeger</li>
<li>otlp</li>
<li>sentry</li>
</ul>
<h4 id="traceprobability"><a class="header" href="#traceprobability"><code>$.trace.probability</code></a></h4>
<p>a float value</p>
<p>The probability a trace will occur.</p>
<h3 id="tracejaeger"><a class="header" href="#tracejaeger"><code>$.trace.jaeger</code></a></h3>
<p>Defines values for Jaeger tracing.</p>
<p><em><strong>NOTE</strong></em>: Jaeger has deprecated using the <code>jaeger</code> protocol and encouraging users to migrate to OTLP,
which Jaeger can ingest natively.</p>
<h4 id="tracejaegeragent"><a class="header" href="#tracejaegeragent"><code>$.trace.jaeger.agent</code></a></h4>
<p>Defines values for configuring delivery to a Jaeger agent.</p>
<h4 id="tracejaegeragentendpoint"><a class="header" href="#tracejaegeragentendpoint"><code>$.trace.jaeger.agent.endpoint</code></a></h4>
<p>a string value</p>
<p>An address in <code>&lt;host&gt;:&lt;post&gt;</code> syntax where traces can be submitted.</p>
<h4 id="tracejaegercollector"><a class="header" href="#tracejaegercollector"><code>$.trace.jaeger.collector</code></a></h4>
<p>Defines values for configuring delivery to a Jaeger collector.</p>
<h4 id="tracejaegercollectorendpoint"><a class="header" href="#tracejaegercollectorendpoint"><code>$.trace.jaeger.collector.endpoint</code></a></h4>
<p>a string value</p>
<p>An address in <code>&lt;host&gt;:&lt;post&gt;</code> syntax where traces can be submitted.</p>
<h4 id="tracejaegercollectorusername"><a class="header" href="#tracejaegercollectorusername"><code>$.trace.jaeger.collector.username</code></a></h4>
<p>a string value</p>
<h4 id="tracejaegercollectorpassword"><a class="header" href="#tracejaegercollectorpassword"><code>$.trace.jaeger.collector.password</code></a></h4>
<p>a string value</p>
<h4 id="tracejaegerservice_name"><a class="header" href="#tracejaegerservice_name"><code>$.trace.jaeger.service_name</code></a></h4>
<p>a string value</p>
<h4 id="tracejaegertags"><a class="header" href="#tracejaegertags"><code>$.trace.jaeger.tags</code></a></h4>
<p>a mapping of a string to a string</p>
<h4 id="tracejaegerbuffer_max"><a class="header" href="#tracejaegerbuffer_max"><code>$.trace.jaeger.buffer_max</code></a></h4>
<p>an integer value</p>
<h3 id="traceotlp"><a class="header" href="#traceotlp"><code>$.trace.otlp</code></a></h3>
<p>Configuration for OTLP traces.</p>
<p>Only one of the <code>http</code> or <code>grpc</code> keys should be provided.</p>
<h4 id="traceotlphttp"><a class="header" href="#traceotlphttp"><code>$.trace.otlp.http</code></a></h4>
<p>Configuration for OTLP traces submitted by HTTP.</p>
<h5 id="traceotlphttpurl_path"><a class="header" href="#traceotlphttpurl_path"><code>$.trace.otlp.http.url_path</code></a></h5>
<p>Request path to use for submissions.
Defaults to <code>/v1/traces</code>.</p>
<h5 id="traceotlphttpcompression"><a class="header" href="#traceotlphttpcompression"><code>$.trace.otlp.http.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="traceotlphttpendpoint"><a class="header" href="#traceotlphttpendpoint"><code>$.trace.otlp.http.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4318</code>.</p>
<h5 id="traceotlphttpheaders"><a class="header" href="#traceotlphttpheaders"><code>$.trace.otlp.http.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="traceotlphttpinsecure"><a class="header" href="#traceotlphttpinsecure"><code>$.trace.otlp.http.insecure</code></a></h5>
<p>Use HTTP instead of HTTPS.</p>
<h5 id="traceotlphttptimeout"><a class="header" href="#traceotlphttptimeout"><code>$.trace.otlp.http.timeout</code></a></h5>
<p>Maximum of of time for a trace submission.</p>
<h5 id="traceotlphttpclient_tlscert"><a class="header" href="#traceotlphttpclient_tlscert"><code>$.trace.otlp.http.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="traceotlphttpclient_tlskey"><a class="header" href="#traceotlphttpclient_tlskey"><code>$.trace.otlp.http.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<h4 id="traceotlpgrpc"><a class="header" href="#traceotlpgrpc"><code>$.trace.otlp.grpc</code></a></h4>
<p>Configuration for OTLP traces submitted by gRPC.</p>
<h5 id="traceotlpgrpcreconnect"><a class="header" href="#traceotlpgrpcreconnect"><code>$.trace.otlp.grpc.reconnect</code></a></h5>
<p>Sets the minimum time between connection attempts.</p>
<h5 id="traceotlpgrpcservice_config"><a class="header" href="#traceotlpgrpcservice_config"><code>$.trace.otlp.grpc.service_config</code></a></h5>
<p>A string containing a JSON-format gRPC service config.</p>
<h5 id="traceotlpgrpccompression"><a class="header" href="#traceotlpgrpccompression"><code>$.trace.otlp.grpc.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="traceotlpgrpcendpoint"><a class="header" href="#traceotlpgrpcendpoint"><code>$.trace.otlp.grpc.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4317</code>.</p>
<h5 id="traceotlpgrpcheaders"><a class="header" href="#traceotlpgrpcheaders"><code>$.trace.otlp.grpc.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="traceotlpgrpcinsecure"><a class="header" href="#traceotlpgrpcinsecure"><code>$.trace.otlp.grpc.insecure</code></a></h5>
<p>Do not verify the server certificate.</p>
<h5 id="traceotlpgrpctimeout"><a class="header" href="#traceotlpgrpctimeout"><code>$.trace.otlp.grpc.timeout</code></a></h5>
<p>Maximum of of time for a trace submission.</p>
<h5 id="traceotlpgrpcclient_tlscert"><a class="header" href="#traceotlpgrpcclient_tlscert"><code>$.trace.otlp.grpc.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="traceotlpgrpcclient_tlskey"><a class="header" href="#traceotlpgrpcclient_tlskey"><code>$.trace.otlp.grpc.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<h3 id="tracesentry"><a class="header" href="#tracesentry"><code>$.trace.sentry</code></a></h3>
<p>Configuration for submitting traces to Sentry.</p>
<p>This is done via OpenTelemetry instrumentation, so may not provide identical
results compared to other tracing backends or native Sentry instrumentation.</p>
<p>There’s no integration for error submission.
This means that alternative implementations of the Sentry API that do not support submitting traces (such as <a href="https://glitchtip.com/">GlitchTip</a>) are not usable.</p>
<h4 id="tracesentrydsn"><a class="header" href="#tracesentrydsn"><code>$.trace.sentry.dsn</code></a></h4>
<p>Sentry DSN to use.
See also <a href="https://pkg.go.dev/github.com/getsentry/sentry-go#ClientOptions"><code>sentry-go.ClientOptions</code></a>.</p>
<h4 id="tracesentryenvironment"><a class="header" href="#tracesentryenvironment"><code>$.trace.sentry.environment</code></a></h4>
<p>Sentry environment to use.
See also <a href="https://pkg.go.dev/github.com/getsentry/sentry-go#ClientOptions"><code>sentry-go.ClientOptions</code></a>.</p>
<h3 id="metrics"><a class="header" href="#metrics"><code>$.metrics</code></a></h3>
<p>Defines distributed tracing configuration based on OpenTelemetry.</p>
<h4 id="metricsname"><a class="header" href="#metricsname"><code>$.metrics.name</code></a></h4>
<p>a string value</p>
<h3 id="metricsprometheus"><a class="header" href="#metricsprometheus"><code>$.metrics.prometheus</code></a></h3>
<p>Configuration for a prometheus metrics exporter.</p>
<h4 id="metricsprometheusendpoint"><a class="header" href="#metricsprometheusendpoint"><code>$.metrics.prometheus.endpoint</code></a></h4>
<p>a string value</p>
<p>Defines the path where metrics will be served.</p>
<h3 id="metricsotlp"><a class="header" href="#metricsotlp"><code>$.metrics.otlp</code></a></h3>
<p>Configuration for OTLP metrics.</p>
<p>Only one of the <code>http</code> or <code>grpc</code> keys should be provided.</p>
<h4 id="metricsotlphttp"><a class="header" href="#metricsotlphttp"><code>$.metrics.otlp.http</code></a></h4>
<p>Configuration for OTLP metrics submitted by HTTP.</p>
<h5 id="metricsotlphttpurl_path"><a class="header" href="#metricsotlphttpurl_path"><code>$.metrics.otlp.http.url_path</code></a></h5>
<p>Request path to use for submissions.
Defaults to <code>/v1/metrics</code>.</p>
<h5 id="metricsotlphttpcompression"><a class="header" href="#metricsotlphttpcompression"><code>$.metrics.otlp.http.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="metricsotlphttpendpoint"><a class="header" href="#metricsotlphttpendpoint"><code>$.metrics.otlp.http.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4318</code>.</p>
<h5 id="metricsotlphttpheaders"><a class="header" href="#metricsotlphttpheaders"><code>$.metrics.otlp.http.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="metricsotlphttpinsecure"><a class="header" href="#metricsotlphttpinsecure"><code>$.metrics.otlp.http.insecure</code></a></h5>
<p>Use HTTP instead of HTTPS.</p>
<h5 id="metricsotlphttptimeout"><a class="header" href="#metricsotlphttptimeout"><code>$.metrics.otlp.http.timeout</code></a></h5>
<p>Maximum of of time for a metrics submission.</p>
<h5 id="metricsotlphttpclient_tlscert"><a class="header" href="#metricsotlphttpclient_tlscert"><code>$.metrics.otlp.http.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="metricsotlphttpclient_tlskey"><a class="header" href="#metricsotlphttpclient_tlskey"><code>$.metrics.otlp.http.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<h4 id="metricsotlpgrpc"><a class="header" href="#metricsotlpgrpc"><code>$.metrics.otlp.grpc</code></a></h4>
<p>Configuration for OTLP metrics submitted by gRPC.</p>
<h5 id="metricsotlpgrpcreconnect"><a class="header" href="#metricsotlpgrpcreconnect"><code>$.metrics.otlp.grpc.reconnect</code></a></h5>
<p>Sets the minimum time between connection attempts.</p>
<h5 id="metricsotlpgrpcservice_config"><a class="header" href="#metricsotlpgrpcservice_config"><code>$.metrics.otlp.grpc.service_config</code></a></h5>
<p>A string containing a JSON-format gRPC service config.</p>
<h5 id="metricsotlpgrpccompression"><a class="header" href="#metricsotlpgrpccompression"><code>$.metrics.otlp.grpc.compression</code></a></h5>
<p>Compression for payloads.
One of:</p>
<ul>
<li>gzip</li>
<li>none</li>
</ul>
<h5 id="metricsotlpgrpcendpoint"><a class="header" href="#metricsotlpgrpcendpoint"><code>$.metrics.otlp.grpc.endpoint</code></a></h5>
<p><code>Host:port</code> for submission. Defaults to <code>localhost:4318</code>.</p>
<h5 id="metricsotlpgrpcheaders"><a class="header" href="#metricsotlpgrpcheaders"><code>$.metrics.otlp.grpc.headers</code></a></h5>
<p>Key-value pairs of additional headers for submissions.</p>
<h5 id="metricsotlpgrpcinsecure"><a class="header" href="#metricsotlpgrpcinsecure"><code>$.metrics.otlp.grpc.insecure</code></a></h5>
<p>Use HTTP instead of HTTPS.</p>
<h5 id="metricsotlpgrpctimeout"><a class="header" href="#metricsotlpgrpctimeout"><code>$.metrics.otlp.grpc.timeout</code></a></h5>
<p>Maximum of of time for a metrics submission.</p>
<h5 id="metricsotlpgrpcclient_tlscert"><a class="header" href="#metricsotlpgrpcclient_tlscert"><code>$.metrics.otlp.grpc.client_tls.cert</code></a></h5>
<p>Client certificate for connection.</p>
<h5 id="metricsotlpgrpcclient_tlskey"><a class="header" href="#metricsotlpgrpcclient_tlskey"><code>$.metrics.otlp.grpc.client_tls.key</code></a></h5>
<p>Key for the certificate specified in <code>cert</code>.</p>
<hr>
<hr>
<ol class="footnote-definition">
<li id="footnote-1">
<p>Support added in version <code>4.7.0</code>. <a href="#fr-1-1">↩</a> <a href="#fr-1-2">↩2</a></p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="indexer-1"><a class="header" href="#indexer-1">Indexer</a></h1>
<p>When Clair is running in Indexer mode, it is responsible for receiving Manifests and generating IndexReports. An IndexReport is an intermediate representation of a manifest’s content and is used to discover vulnerabilities.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="matcher-1"><a class="header" href="#matcher-1">Matcher</a></h1>
<p>When Clair is running in Matcher mode it is responsible for receiving IndexReports and generating VulnerabilityReports. A VulnerabilityReport describes the contents of a manifest and any vulnerabilities affecting it.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="notifier-1"><a class="header" href="#notifier-1">Notifier</a></h1>
<p>When Clair is running in Notifier mode, it is responsible for generating notifications when new vulnerabilities affecting a previously indexed manifest enters the system. The notifier will send notifications via the configured mechanisms.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="metrics-1"><a href="#metrics-1" class="header">Metrics</a></h1>
<p>Clair exports <a href="#metrics">metrics</a> on the <a href="#introspection_addr">introspection
port</a> in the Prometheus format.</p>
<p>The exact metrics exposed are not considered API (and so are subject to change
between releases) but should be well described. An up-to-date grafana dashboard
example is in <code>contrib/openshift/grafana</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
