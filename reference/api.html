<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Api - Clair Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Documentation for Clair.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "coal";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Clair Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/quay/clair" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<p>title: Clair Container Analyzer v1.2.0
language_tabs:</p>
<ul>
<li>python: Python</li>
<li>go: Golang</li>
<li>javascript: Javascript
language_clients:</li>
<li>python: ""</li>
<li>go: ""</li>
<li>javascript: ""
toc_footers:</li>
<li><a href="https://quay.github.io/clair/">External documentation</a>
includes: []
search: false
highlight_theme: darkula
headingLevel: 2</li>
</ul>
<hr />
<!-- Generator: Widdershins v4.0.1 -->
<h1 id="clair-container-analyzer"><a class="header" href="#clair-container-analyzer">Clair Container Analyzer v1.2.0</a></h1>
<blockquote>
<p>Scroll down for code samples, example requests and responses. Select a language for code samples from the tabs above or the mobile navigation menu.</p>
</blockquote>
<p>Clair is a set of cooperating microservices which can index and match a container image's content with known vulnerabilities.</p>
<p><strong>Note:</strong> Any endpoints tagged "internal" are documented for completeness but are considered exempt from versioning.</p>
<p>Email: <a href="mailto:clair-devel@googlegroups.com">Clair Team</a> Web: <a href="http://github.com/quay/clair">Clair Team</a>
License: <a href="http://www.apache.org/licenses/">Apache License 2.0</a></p>
<h1 id="authentication"><a class="header" href="#authentication">Authentication</a></h1>
<ul>
<li>HTTP Authentication, scheme: bearer Clair's authentication scheme.</li>
</ul>
<p>This is a <a href="https://datatracker.ietf.org/doc/html/rfc7519">JWT</a> signed with a configured pre-shared key containing an allowlisted <code>iss</code> claim.</p>
<h1 id="clair-container-analyzer-indexer"><a class="header" href="#clair-container-analyzer-indexer">indexer</a></h1>
<p>Indexer service endpoints.</p>
<p>These are responsible for determining the contents of containers.</p>
<h2 id="index-a-manifest"><a class="header" href="#index-a-manifest">Index a Manifest</a></h2>
<p><a id="opIdIndex"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/vnd.clair.manifest.v1+json',
  'Accept': 'application/vnd.clair.index_report.v1+json'
}

r = requests.post('/indexer/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/vnd.clair.manifest.v1+json"},
        "Accept": []string{"application/vnd.clair.index_report.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("POST", "/indexer/api/v1/index_report", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "Authoriztion": [
          "Bearer hunter2"
        ]
      }
    }
  ]
}';
const headers = {
  'Content-Type':'application/vnd.clair.manifest.v1+json',
  'Accept':'application/vnd.clair.index_report.v1+json'
};

fetch('/indexer/api/v1/index_report',
{
  method: 'POST',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>POST /indexer/api/v1/index_report</code></p>
<p>By submitting a Manifest object to this endpoint Clair will fetch the layers, scan each layer's contents, and provide an index of discovered packages, repository and distribution information.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "Authoriztion": [
          "Bearer hunter2"
        ]
      }
    }
  ]
}
</code></pre>
<h3 id="index-a-manifest-parameters"><a class="header" href="#index-a-manifest-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>body</td><td>body</td><td><a href="#schemamanifest">manifest</a></td><td>true</td><td>Manifest to index.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": null,
  "state": "string",
  "err": "string",
  "success": true,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  }
}
</code></pre>
<h3 id="index-a-manifest-responses"><a class="header" href="#index-a-manifest-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>IndexReport created.</td><td></td></tr>
</tbody></table>
</div>
<p>Clients may want to avoid reading the body if simply submitting the manifest for later vulnerability reporting.|<a href="#schemaindex_report">index_report</a>|
|400|<a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a>|Bad Request|<a href="#schemaerror">error</a>|
|412|<a href="https://tools.ietf.org/html/rfc7232#section-4.2">Precondition Failed</a>|Precondition Failed|None|
|415|<a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a>|Unsupported Media Type|<a href="#schemaerror">error</a>|
|default|Default|Internal Server Error|<a href="#schemaerror">error</a>|</p>
<h3 id="response-headers"><a class="header" href="#response-headers">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>201</td><td>Location</td><td>string</td><td></td><td>HTTP <a href="https://httpwg.org/specs/rfc9110.html#field.location">Location header</a></td></tr>
<tr><td>201</td><td>Link</td><td>string</td><td></td><td>Web Linking <a href="https://httpwg.org/specs/rfc8288.html#header">Link header</a></td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="delete-indexed-manifests"><a class="header" href="#delete-indexed-manifests">Delete Indexed Manifests</a></h2>
<p><a id="opIdDeleteManifests"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/vnd.clair.bulk_delete.v1+json',
  'Accept': 'application/vnd.clair.bulk_delete.v1+json'
}

r = requests.delete('/indexer/api/v1/index_report', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/vnd.clair.bulk_delete.v1+json"},
        "Accept": []string{"application/vnd.clair.bulk_delete.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/indexer/api/v1/index_report", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]';
const headers = {
  'Content-Type':'application/vnd.clair.bulk_delete.v1+json',
  'Accept':'application/vnd.clair.bulk_delete.v1+json'
};

fetch('/indexer/api/v1/index_report',
{
  method: 'DELETE',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /indexer/api/v1/index_report</code></p>
<p>Given a Manifest's content addressable hash, any data related to it will be removed if it exists.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]
</code></pre>
<h3 id="delete-indexed-manifests-parameters"><a class="header" href="#delete-indexed-manifests-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>body</td><td>body</td><td><a href="#schemabulk_delete">bulk_delete</a></td><td>true</td><td>Array of manifest digests to delete.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]
</code></pre>
<h3 id="delete-indexed-manifests-responses"><a class="header" href="#delete-indexed-manifests-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Successfully deleted manifests.</td><td><a href="#schemabulk_delete">bulk_delete</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-1"><a class="header" href="#response-headers-1">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="delete-an-indexed-manifest"><a class="header" href="#delete-an-indexed-manifest">Delete an Indexed Manifest</a></h2>
<p><a id="opIdDeleteManifest"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.error.v1+json'
}

r = requests.delete('/indexer/api/v1/index_report/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.error.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/indexer/api/v1/index_report/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.error.v1+json'
};

fetch('/indexer/api/v1/index_report/{digest}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /indexer/api/v1/index_report/{digest}</code></p>
<p>Given a Manifest's content addressable hash, any data related to it will be removed it it exists.</p>
<h3 id="delete-an-indexed-manifest-parameters"><a class="header" href="#delete-an-indexed-manifest-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-an-indexed-manifest-responses"><a class="header" href="#delete-an-indexed-manifest-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>204</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.5">No Content</a></td><td>Success</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-the-indexreport-for-a-manifest"><a class="header" href="#retrieve-the-indexreport-for-a-manifest">Retrieve the IndexReport for a Manifest</a></h2>
<p><a id="opIdGetIndexReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.index_report.v1+json'
}

r = requests.get('/indexer/api/v1/index_report/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.index_report.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/indexer/api/v1/index_report/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.index_report.v1+json'
};

fetch('/indexer/api/v1/index_report/{digest}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /indexer/api/v1/index_report/{digest}</code></p>
<p>Given a Manifest's content addressable hash, an IndexReport will be retrieved if it exists.</p>
<h3 id="retrieve-the-indexreport-for-a-manifest-parameters"><a class="header" href="#retrieve-the-indexreport-for-a-manifest-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": null,
  "state": "string",
  "err": "string",
  "success": true,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  }
}
</code></pre>
<h3 id="retrieve-the-indexreport-for-a-manifest-responses"><a class="header" href="#retrieve-the-indexreport-for-a-manifest-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>IndexReport retrieved</td><td><a href="#schemaindex_report">index_report</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-2"><a class="header" href="#response-headers-2">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="report-the-indexers-state"><a class="header" href="#report-the-indexers-state">Report the Indexer's State</a></h2>
<p><a id="opIdIndexState"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.index_state.v1+json'
}

r = requests.get('/indexer/api/v1/index_state', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.index_state.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/indexer/api/v1/index_state", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.index_state.v1+json'
};

fetch('/indexer/api/v1/index_state',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /indexer/api/v1/index_state</code></p>
<p>The index state endpoint returns a json structure indicating the indexer's internal configuration state.
A client may be interested in this as a signal that manifests may need to be re-indexed.</p>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "state": "string"
}
</code></pre>
<h3 id="report-the-indexer's-state-responses"><a class="header" href="#report-the-indexer's-state-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Indexer State</td><td><a href="#schemaindex_state">index_state</a></td></tr>
<tr><td>304</td><td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">Not Modified</a></td><td>Not Modified</td><td>None</td></tr>
</tbody></table>
</div>
<h3 id="response-headers-3"><a class="header" href="#response-headers-3">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Etag</td><td>string</td><td></td><td>HTTP <a href="https://httpwg.org/specs/rfc9110.html#field.etag">ETag header</a></td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="clair-container-analyzer-matcher"><a class="header" href="#clair-container-analyzer-matcher">matcher</a></h1>
<p>Matcher service endpoints.</p>
<p>These are responsible for generating reports against current vulnerability data.</p>
<h2 id="retrieve-a-vulnerabilityreport-for-a-manifest"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-manifest">Retrieve a VulnerabilityReport for a Manifest</a></h2>
<p><a id="opIdGetVulnerabilityReport"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.vulnerability_report.v1+json'
}

r = requests.get('/matcher/api/v1/vulnerability_report/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.vulnerability_report.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/vulnerability_report/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.vulnerability_report.v1+json'
};

fetch('/matcher/api/v1/vulnerability_report/{digest}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/vulnerability_report/{digest}</code></p>
<p>Given a Manifest's content addressable hash a VulnerabilityReport will be created. The Manifest <strong>must</strong> have been Indexed first via the Index endpoint.</p>
<h3 id="retrieve-a-vulnerabilityreport-for-a-manifest-parameters"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-manifest-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>201 Response</p>
</blockquote>
<pre><code class="language-json">{
  "manifest_hash": null,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  },
  "vulnerabilities": {},
  "package_vulnerabilities": {
    "property1": [
      "string"
    ],
    "property2": [
      "string"
    ]
  },
  "enrichments": {
    "property1": [],
    "property2": []
  }
}
</code></pre>
<h3 id="retrieve-a-vulnerabilityreport-for-a-manifest-responses"><a class="header" href="#retrieve-a-vulnerabilityreport-for-a-manifest-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>201</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.2">Created</a></td><td>Vulnerability Report Created</td><td><a href="#schemavulnerability_report">vulnerability_report</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>404</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.4">Not Found</a></td><td>Not Found</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="clair-container-analyzer-notifier"><a class="header" href="#clair-container-analyzer-notifier">notifier</a></h1>
<p>Matcher service endpoints.</p>
<p>These are responsible for serving notifications.</p>
<h2 id="delete-a-notification-set"><a class="header" href="#delete-a-notification-set">Delete a Notification Set</a></h2>
<p><a id="opIdDeleteNotification"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.error.v1+json'
}

r = requests.delete('/notifier/api/v1/notification/{id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.error.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/notifier/api/v1/notification/{id}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.error.v1+json'
};

fetch('/notifier/api/v1/notification/{id}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /notifier/api/v1/notification/{id}</code></p>
<p>Issues a delete of the provided notification ID and all associated notifications.
After this delete clients will no longer be able to retrieve notifications.</p>
<h3 id="delete-a-notification-set-parameters"><a class="header" href="#delete-a-notification-set-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>path</td><td><a href="#schematoken">token</a></td><td>true</td><td>A notification ID returned by a callback</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-a-notification-set-responses"><a class="header" href="#delete-a-notification-set-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Delete the notification referenced by the "id" parameter.</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-4"><a class="header" href="#response-headers-4">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-pages-of-a-notification-set"><a class="header" href="#retrieve-pages-of-a-notification-set">Retrieve Pages of a Notification Set</a></h2>
<p><a id="opIdGetNotification"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.notification_page.v1+json'
}

r = requests.get('/notifier/api/v1/notification/{id}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.notification_page.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/notifier/api/v1/notification/{id}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.notification_page.v1+json'
};

fetch('/notifier/api/v1/notification/{id}',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /notifier/api/v1/notification/{id}</code></p>
<p>By performing a GET with an id as a path parameter, the client will retrieve a paginated response of notification objects.</p>
<h3 id="retrieve-pages-of-a-notification-set-parameters"><a class="header" href="#retrieve-pages-of-a-notification-set-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>page_size</td><td>query</td><td>integer</td><td>false</td><td>The maximum number of notifications to deliver in a single page.</td></tr>
<tr><td>next</td><td>query</td><td><a href="#schematoken">token</a></td><td>false</td><td>The next page to fetch via id. Typically this number is provided on initial response in the "page.next" field. The first request should omit this field.</td></tr>
<tr><td>id</td><td>path</td><td><a href="#schematoken">token</a></td><td>true</td><td>A notification ID returned by a callback</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "page": {
    "size": 100,
    "next": "1b4d0db2-e757-4150-bbbb-543658144205"
  },
  "notifications": [
    {
      "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
      "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
      "reason": "added",
      "vulnerability": {
        "name": "CVE-2009-5155",
        "fixed_in_version": "v0.0.1",
        "links": "http://example.com/CVE-2009-5155",
        "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
        "normalized_severity": "Unknown",
        "package": {
          "id": "10",
          "name": "libapt-pkg5.0",
          "version": "1.6.11",
          "kind": "BINARY",
          "arch": "x86",
          "source": {
            "id": "9",
            "name": "apt",
            "version": "1.6.11",
            "kind": "SOURCE",
            "source": null
          }
        },
        "distribution": {
          "id": "1",
          "did": "ubuntu",
          "name": "Ubuntu",
          "version": "18.04.3 LTS (Bionic Beaver)",
          "version_code_name": "bionic",
          "version_id": "18.04",
          "pretty_name": "Ubuntu 18.04.3 LTS"
        }
      }
    }
  ]
}
</code></pre>
<h3 id="retrieve-pages-of-a-notification-set-responses"><a class="header" href="#retrieve-pages-of-a-notification-set-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>A paginated list of notifications</td><td><a href="#schemanotification_page">notification_page</a></td></tr>
<tr><td>304</td><td><a href="https://tools.ietf.org/html/rfc7232#section-4.1">Not Modified</a></td><td>Not Modified</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-5"><a class="header" href="#response-headers-5">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="clair-container-analyzer-internal"><a class="header" href="#clair-container-analyzer-internal">internal</a></h1>
<p>These are internal endpoints, documented for completeness.</p>
<p>They are exempted from API stability guarentees.</p>
<h2 id="retrieve-manifests-affected-by-a-vulnerability"><a class="header" href="#retrieve-manifests-affected-by-a-vulnerability">Retrieve Manifests Affected by a Vulnerability</a></h2>
<p><a id="opIdAffectedManifests"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Content-Type': 'application/vnd.clair.vulnerability_summaries.v1+json',
  'Accept': 'application/vnd.clair.affected_manifests.v1+json'
}

r = requests.post('/indexer/api/v1/internal/affected_manifest', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Content-Type": []string{"application/vnd.clair.vulnerability_summaries.v1+json"},
        "Accept": []string{"application/vnd.clair.affected_manifests.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("POST", "/indexer/api/v1/internal/affected_manifest", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">const inputBody = '[]';
const headers = {
  'Content-Type':'application/vnd.clair.vulnerability_summaries.v1+json',
  'Accept':'application/vnd.clair.affected_manifests.v1+json'
};

fetch('/indexer/api/v1/internal/affected_manifest',
{
  method: 'POST',
  body: inputBody,
  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>POST /indexer/api/v1/internal/affected_manifest</code></p>
<p>The provided vulnerability summaries are attempted to be run "backwards" through the indexer to produce a set of manifests.</p>
<blockquote>
<p>Body parameter</p>
</blockquote>
<pre><code class="language-json">[]
</code></pre>
<h3 id="retrieve-manifests-affected-by-a-vulnerability-parameters"><a class="header" href="#retrieve-manifests-affected-by-a-vulnerability-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>body</td><td>body</td><td><a href="#schemavulnerability_summaries">vulnerability_summaries</a></td><td>true</td><td>Array of vulnerability summaries to report on.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "vulnerabilities": {
    "42": {
      "id": "42"
    }
  },
  "vulnerable_manifests": {
    "sha256:01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b": [
      "42"
    ]
  }
}
</code></pre>
<h3 id="retrieve-manifests-affected-by-a-vulnerability-responses"><a class="header" href="#retrieve-manifests-affected-by-a-vulnerability-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>The list of manifests and the corresponding vulnerabilities.</td><td><a href="#schemaaffected_manifests">affected_manifests</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-6"><a class="header" href="#response-headers-6">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-vulnerability-changes-between-two-update-operations"><a class="header" href="#retrieve-vulnerability-changes-between-two-update-operations">Retrieve Vulnerability Changes Between Two Update Operations</a></h2>
<p><a id="opIdGetUpdateDiff"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.update_diff.v1+json'
}

r = requests.get('/matcher/api/v1/internal/update_diff', params={
  'prev': 'string'
}, headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.update_diff.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/internal/update_diff", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.update_diff.v1+json'
};

fetch('/matcher/api/v1/internal/update_diff?prev=string',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/internal/update_diff</code></p>
<p>Given IDs for two Update Operations, this will return the difference between them. This is used in the notification flow.</p>
<h3 id="retrieve-vulnerability-changes-between-two-update-operations-parameters"><a class="header" href="#retrieve-vulnerability-changes-between-two-update-operations-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>cur</td><td>query</td><td><a href="#schematoken">token</a></td><td>false</td><td>"Current" Update Operation ref.</td></tr>
<tr><td>prev</td><td>query</td><td><a href="#schematoken">token</a></td><td>true</td><td>"Previous" Update Operation ref.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "prev": null,
  "cur": null,
  "added": [],
  "removed": []
}
</code></pre>
<h3 id="retrieve-vulnerability-changes-between-two-update-operations-responses"><a class="header" href="#retrieve-vulnerability-changes-between-two-update-operations-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Changes between two Update Operations.</td><td><a href="#schemaupdate_diff">update_diff</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-7"><a class="header" href="#response-headers-7">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="retrieve-update-operations"><a class="header" href="#retrieve-update-operations">Retrieve Update Operations</a></h2>
<p><a id="opIdGetUpdateOperation"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.update_operations.v1+json'
}

r = requests.get('/matcher/api/v1/internal/update_operation', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.update_operations.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("GET", "/matcher/api/v1/internal/update_operation", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.update_operations.v1+json'
};

fetch('/matcher/api/v1/internal/update_operation',
{
  method: 'GET',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>GET /matcher/api/v1/internal/update_operation</code></p>
<p>Retrive all known or just the latest Update Operations.</p>
<h3 id="retrieve-update-operations-parameters"><a class="header" href="#retrieve-update-operations-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>kind</td><td>query</td><td>any</td><td>false</td><td>The "kind" of updaters to query.</td></tr>
<tr><td>latest</td><td>query</td><td>boolean</td><td>false</td><td>Return only the latest Update Operations instead of all known Update Operations.</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values"><a class="header" href="#enumerated-values">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody>
<tr><td>kind</td><td>vulnerability</td></tr>
<tr><td>kind</td><td>enrichment</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>200 Response</p>
</blockquote>
<pre><code class="language-json">{
  "property1": [],
  "property2": []
}
</code></pre>
<h3 id="retrieve-update-operations-responses"><a class="header" href="#retrieve-update-operations-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Update Operations, keyed by updater.</td><td><a href="#schemaupdate_operations">update_operations</a></td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-8"><a class="header" href="#response-headers-8">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h2 id="delete-an-update-operation"><a class="header" href="#delete-an-update-operation">Delete an Update Operation</a></h2>
<p><a id="opIdDeleteUpdateOperation"></a></p>
<blockquote>
<p>Code samples</p>
</blockquote>
<pre><code class="language-python">import requests
headers = {
  'Accept': 'application/vnd.clair.error.v1+json'
}

r = requests.delete('/matcher/api/v1/internal/update_operation/{digest}', headers = headers)

print(r.json())

</code></pre>
<pre><code class="language-go">package main

import (
       "bytes"
       "net/http"
)

func main() {

    headers := map[string][]string{
        "Accept": []string{"application/vnd.clair.error.v1+json"},
    }

    data := bytes.NewBuffer([]byte{jsonReq})
    req, err := http.NewRequest("DELETE", "/matcher/api/v1/internal/update_operation/{digest}", data)
    req.Header = headers

    client := &amp;http.Client{}
    resp, err := client.Do(req)
    // ...
}

</code></pre>
<pre><code class="language-javascript">
const headers = {
  'Accept':'application/vnd.clair.error.v1+json'
};

fetch('/matcher/api/v1/internal/update_operation/{digest}',
{
  method: 'DELETE',

  headers: headers
})
.then(function(res) {
    return res.json();
}).then(function(body) {
    console.log(body);
});

</code></pre>
<p><code>DELETE /matcher/api/v1/internal/update_operation/{digest}</code></p>
<p>Issues a delete of the provided Update Operation ID and all associated data.
After this delete clients will no longer be able to generate a diff against this Update Operation.</p>
<h3 id="delete-an-update-operation-parameters"><a class="header" href="#delete-an-update-operation-parameters">Parameters</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>In</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody>
<tr><td>digest</td><td>path</td><td><a href="#schemadigest">digest</a></td><td>true</td><td>OCI-compatible digest of a referred object.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>Example responses</p>
</blockquote>
<blockquote>
<p>400 Response</p>
</blockquote>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}
</code></pre>
<h3 id="delete-an-update-operation-responses"><a class="header" href="#delete-an-update-operation-responses">Responses</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Meaning</th><th>Description</th><th>Schema</th></tr></thead><tbody>
<tr><td>200</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">OK</a></td><td>Success</td><td>None</td></tr>
<tr><td>400</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.1">Bad Request</a></td><td>Bad Request</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>415</td><td><a href="https://tools.ietf.org/html/rfc7231#section-6.5.13">Unsupported Media Type</a></td><td>Unsupported Media Type</td><td><a href="#schemaerror">error</a></td></tr>
<tr><td>default</td><td>Default</td><td>Internal Server Error</td><td><a href="#schemaerror">error</a></td></tr>
</tbody></table>
</div>
<h3 id="response-headers-9"><a class="header" href="#response-headers-9">Response Headers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Status</th><th>Header</th><th>Type</th><th>Format</th><th>Description</th></tr></thead><tbody>
<tr><td>200</td><td>Clair-Error</td><td>string</td><td></td><td>This is a trailer containing any errors encountered while writing the response.</td></tr>
</tbody></table>
</div><aside class="warning">
To perform this operation, you must be authenticated by means of one of the following methods:
None, PSK
</aside>
<h1 id="schemas"><a class="header" href="#schemas">Schemas</a></h1>
<h2 id="tocS_token"><a class="header" href="#tocS_token">token</a></h2>
<!-- backwards compatibility -->
<a id="schematoken"></a>
<a id="schema_token"></a>
<a id="tocStoken"></a>
<a id="tocstoken"></a>
<pre><code class="language-json">"string"

</code></pre>
<p>An opaque token previously obtained from the service.</p>
<h3 id="properties"><a class="header" href="#properties">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>An opaque token previously obtained from the service.</td></tr>
</tbody></table>
</div><h2 id="tocS_affected_manifests"><a class="header" href="#tocS_affected_manifests">affected_manifests</a></h2>
<!-- backwards compatibility -->
<a id="schemaaffected_manifests"></a>
<a id="schema_affected_manifests"></a>
<a id="tocSaffected_manifests"></a>
<a id="tocsaffected_manifests"></a>
<pre><code class="language-json">{
  "vulnerabilities": {
    "42": {
      "id": "42"
    }
  },
  "vulnerable_manifests": {
    "sha256:01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b": [
      "42"
    ]
  }
}

</code></pre>
<p>Affected Manifests</p>
<h3 id="properties-1"><a class="header" href="#properties-1">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>Vulnerability objects.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemavulnerability.schema.json">vulnerability.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>vulnerable_manifests</td><td>object</td><td>true</td><td>none</td><td>Mapping of manifest digests to vulnerability identifiers.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_bulk_delete"><a class="header" href="#tocS_bulk_delete">bulk_delete</a></h2>
<!-- backwards compatibility -->
<a id="schemabulk_delete"></a>
<a id="schema_bulk_delete"></a>
<a id="tocSbulk_delete"></a>
<a id="tocsbulk_delete"></a>
<pre><code class="language-json">[
  "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3"
]

</code></pre>
<p>Bulk Delete</p>
<h3 id="properties-2"><a class="header" href="#properties-2">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Bulk Delete</td><td>[<a href="#schemadigest.schema.json">digest.schema.json</a>]</td><td>false</td><td>none</td><td>Array of manifest digests to delete from the system.</td></tr>
</tbody></table>
</div><h2 id="tocS_cpe"><a class="header" href="#tocS_cpe">cpe</a></h2>
<!-- backwards compatibility -->
<a id="schemacpe"></a>
<a id="schema_cpe"></a>
<a id="tocScpe"></a>
<a id="tocscpe"></a>
<pre><code class="language-json">"cpe:/a:microsoft:internet_explorer:8.0.6001:beta"

</code></pre>
<p>Common Platform Enumeration Name</p>
<h3 id="properties-3"><a class="header" href="#properties-3">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Common Platform Enumeration Name</td><td>any</td><td>false</td><td>none</td><td>This is a CPE Name in either v2.2 "URI" form or v2.3 "Formatted String" form.</td></tr>
</tbody></table>
</div>
<p>oneOf</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>This is the CPE 2.2 regexp: https://cpe.mitre.org/specification/2.2/cpe-language_2.2.xsd</td></tr>
</tbody></table>
</div>
<p>xor</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>This is the CPE 2.3 regexp: https://csrc.nist.gov/schema/cpe/2.3/cpe-naming_2.3.xsd</td></tr>
</tbody></table>
</div><h2 id="tocS_digest"><a class="header" href="#tocS_digest">digest</a></h2>
<!-- backwards compatibility -->
<a id="schemadigest"></a>
<a id="schema_digest"></a>
<a id="tocSdigest"></a>
<a id="tocsdigest"></a>
<pre><code class="language-json">"sha256:44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a"

</code></pre>
<p>Digest</p>
<h3 id="properties-4"><a class="header" href="#properties-4">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Digest</td><td>string</td><td>false</td><td>none</td><td>A digest acts as a content identifier, enabling content addressability.</td></tr>
</tbody></table>
</div>
<p>anyOf</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>SHA256</td></tr>
</tbody></table>
</div>
<p>or</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>SHA512</td></tr>
</tbody></table>
</div>
<p>or</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>string</td><td>false</td><td>none</td><td>BLAKE3<br><br><strong>Currently not implemented.</strong></td></tr>
</tbody></table>
</div><h2 id="tocS_distribution"><a class="header" href="#tocS_distribution">distribution</a></h2>
<!-- backwards compatibility -->
<a id="schemadistribution"></a>
<a id="schema_distribution"></a>
<a id="tocSdistribution"></a>
<a id="tocsdistribution"></a>
<pre><code class="language-json">{
  "id": "1",
  "did": "ubuntu",
  "name": "Ubuntu",
  "version": "18.04.3 LTS (Bionic Beaver)",
  "version_code_name": "bionic",
  "version_id": "18.04",
  "pretty_name": "Ubuntu 18.04.3 LTS"
}

</code></pre>
<p>Distribution</p>
<h3 id="properties-5"><a class="header" href="#properties-5">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>Unique ID for this Distribution. May be unique to the response document, not the whole system.</td></tr>
<tr><td>did</td><td>string</td><td>false</td><td>none</td><td>A lower-case string (no spaces or other characters outside of 0–9, a–z, ".", "_", and "-") identifying the operating system, excluding any version information and suitable for processing by scripts or usage in generated filenames.</td></tr>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>A string identifying the operating system.</td></tr>
<tr><td>version</td><td>string</td><td>false</td><td>none</td><td>A string identifying the operating system version, excluding any OS name information, possibly including a release code name, and suitable for presentation to the user.</td></tr>
<tr><td>version_code_name</td><td>string</td><td>false</td><td>none</td><td>A lower-case string (no spaces or other characters outside of 0–9, a–z, ".", "_", and "-") identifying the operating system release code name, excluding any OS name information or release version, and suitable for processing by scripts or usage in generated filenames.</td></tr>
<tr><td>version_id</td><td>string</td><td>false</td><td>none</td><td>A lower-case string (mostly numeric, no spaces or other characters outside of 0–9, a–z, ".", "_", and "-") identifying the operating system version, excluding any OS name information or release code name.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>A string identifying the OS architecture.</td></tr>
<tr><td>cpe</td><td><a href="#schemacpe.schema.json">cpe.schema.json</a></td><td>false</td><td>none</td><td>Common Platform Enumeration name.</td></tr>
<tr><td>pretty_name</td><td>string</td><td>false</td><td>none</td><td>A pretty operating system name in a format suitable for presentation to the user.</td></tr>
</tbody></table>
</div><h2 id="tocS_environment"><a class="header" href="#tocS_environment">environment</a></h2>
<!-- backwards compatibility -->
<a id="schemaenvironment"></a>
<a id="schema_environment"></a>
<a id="tocSenvironment"></a>
<a id="tocsenvironment"></a>
<pre><code class="language-json">{
  "value": {
    "package_db": "var/lib/dpkg/status",
    "introduced_in": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
    "distribution_id": "1"
  }
}

</code></pre>
<p>Environment</p>
<h3 id="properties-6"><a class="header" href="#properties-6">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>package_db</td><td>string</td><td>false</td><td>none</td><td>The database the associated Package was discovered in.</td></tr>
<tr><td>distribution_id</td><td>string</td><td>false</td><td>none</td><td>The ID of the Distribution of the associated Package.</td></tr>
<tr><td>introduced_in</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>false</td><td>none</td><td>The Layer the associated Package was introduced in.</td></tr>
<tr><td>repository_ids</td><td>[string]</td><td>false</td><td>none</td><td>The IDs of the Repositories of the associated Package.</td></tr>
</tbody></table>
</div><h2 id="tocS_error"><a class="header" href="#tocS_error">error</a></h2>
<!-- backwards compatibility -->
<a id="schemaerror"></a>
<a id="schema_error"></a>
<a id="tocSerror"></a>
<a id="tocserror"></a>
<pre><code class="language-json">{
  "code": "string",
  "message": "string"
}

</code></pre>
<p>Error</p>
<h3 id="properties-7"><a class="header" href="#properties-7">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>code</td><td>string</td><td>false</td><td>none</td><td>a code for this particular error</td></tr>
<tr><td>message</td><td>string</td><td>true</td><td>none</td><td>a message with further detail</td></tr>
</tbody></table>
</div><h2 id="tocS_index_report"><a class="header" href="#tocS_index_report">index_report</a></h2>
<!-- backwards compatibility -->
<a id="schemaindex_report"></a>
<a id="schema_index_report"></a>
<a id="tocSindex_report"></a>
<a id="tocsindex_report"></a>
<pre><code class="language-json">{
  "manifest_hash": null,
  "state": "string",
  "err": "string",
  "success": true,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  }
}

</code></pre>
<p>Index Report</p>
<h3 id="properties-8"><a class="header" href="#properties-8">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The Manifest's digest.</td></tr>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>The current state of the index operation</td></tr>
<tr><td>err</td><td>string</td><td>false</td><td>none</td><td>An error message on event of unsuccessful index</td></tr>
<tr><td>success</td><td>boolean</td><td>true</td><td>none</td><td>A bool indicating succcessful index</td></tr>
<tr><td>packages</td><td>object</td><td>false</td><td>none</td><td>A map of Package objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemapackage.schema.json">package.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>distributions</td><td>object</td><td>false</td><td>none</td><td>A map of Distribution objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemadistribution.schema.json">distribution.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>repository</td><td>object</td><td>false</td><td>none</td><td>A map of Repository objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemarepository.schema.json">repository.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>environments</td><td>object</td><td>false</td><td>none</td><td>A map of Environment arrays indexed by a Package's identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="#schemaenvironment.schema.json">environment.schema.json</a>]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_index_state"><a class="header" href="#tocS_index_state">index_state</a></h2>
<!-- backwards compatibility -->
<a id="schemaindex_state"></a>
<a id="schema_index_state"></a>
<a id="tocSindex_state"></a>
<a id="tocsindex_state"></a>
<pre><code class="language-json">{
  "state": "string"
}

</code></pre>
<p>Index State</p>
<h3 id="properties-9"><a class="header" href="#properties-9">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>state</td><td>string</td><td>true</td><td>none</td><td>an opaque token</td></tr>
</tbody></table>
</div><h2 id="tocS_layer"><a class="header" href="#tocS_layer">layer</a></h2>
<!-- backwards compatibility -->
<a id="schemalayer"></a>
<a id="schema_layer"></a>
<a id="tocSlayer"></a>
<a id="tocslayer"></a>
<pre><code class="language-json">{
  "hash": null,
  "uri": "string",
  "headers": {},
  "media_type": "string"
}

</code></pre>
<p>Layer</p>
<h3 id="properties-10"><a class="header" href="#properties-10">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>Digest of the layer blob.</td></tr>
<tr><td>uri</td><td>string</td><td>true</td><td>none</td><td>A URI indicating where the layer blob can be downloaded from.</td></tr>
<tr><td>headers</td><td>object</td><td>false</td><td>none</td><td>Any additional HTTP-style headers needed for requesting layers.</td></tr>
<tr><td>» ^[a-zA-Z0-9-_]+$</td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>media_type</td><td>string</td><td>false</td><td>none</td><td>The OCI Layer media type for this layer.</td></tr>
</tbody></table>
</div><h2 id="tocS_manifest"><a class="header" href="#tocS_manifest">manifest</a></h2>
<!-- backwards compatibility -->
<a id="schemamanifest"></a>
<a id="schema_manifest"></a>
<a id="tocSmanifest"></a>
<a id="tocsmanifest"></a>
<pre><code class="language-json">{
  "hash": "sha256:fc84b5febd328eccaa913807716887b3eb5ed08bc22cc6933a9ebf82766725e3",
  "layers": [
    {
      "hash": "sha256:2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "uri": "https://storage.example.com/blob/2f077db56abccc19f16f140f629ae98e904b4b7d563957a7fc319bd11b82ba36",
      "headers": {
        "Authoriztion": [
          "Bearer hunter2"
        ]
      }
    }
  ]
}

</code></pre>
<p>Manifest</p>
<h3 id="properties-11"><a class="header" href="#properties-11">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The OCI Image Manifest's digest.<br><br>This is used as an identifier throughout the system. This <strong>SHOULD</strong> be the same as the OCI Image Manifest's digest, but this is not enforced.</td></tr>
<tr><td>layers</td><td>[<a href="#schemalayer.schema.json">layer.schema.json</a>]</td><td>false</td><td>none</td><td>The OCI Layers making up the Image, in order.</td></tr>
</tbody></table>
</div><h2 id="tocS_normalized_severity"><a class="header" href="#tocS_normalized_severity">normalized_severity</a></h2>
<!-- backwards compatibility -->
<a id="schemanormalized_severity"></a>
<a id="schema_normalized_severity"></a>
<a id="tocSnormalized_severity"></a>
<a id="tocsnormalized_severity"></a>
<pre><code class="language-json">"Unknown"

</code></pre>
<p>Normalized Severity</p>
<h3 id="properties-12"><a class="header" href="#properties-12">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Normalized Severity</td><td>any</td><td>false</td><td>none</td><td>Standardized severity values.</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values-1"><a class="header" href="#enumerated-values-1">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>Normalized Severity</td><td>Unknown</td></tr>
<tr><td>Normalized Severity</td><td>Negligible</td></tr>
<tr><td>Normalized Severity</td><td>Low</td></tr>
<tr><td>Normalized Severity</td><td>Medium</td></tr>
<tr><td>Normalized Severity</td><td>High</td></tr>
<tr><td>Normalized Severity</td><td>Critical</td></tr>
</tbody></table>
</div><h2 id="tocS_notification_page"><a class="header" href="#tocS_notification_page">notification_page</a></h2>
<!-- backwards compatibility -->
<a id="schemanotification_page"></a>
<a id="schema_notification_page"></a>
<a id="tocSnotification_page"></a>
<a id="tocsnotification_page"></a>
<pre><code class="language-json">{
  "page": {
    "size": 100,
    "next": "1b4d0db2-e757-4150-bbbb-543658144205"
  },
  "notifications": [
    {
      "id": "5e4b387e-88d3-4364-86fd-063447a6fad2",
      "manifest": "sha256:35c102085707f703de2d9eaad8752d6fe1b8f02b5d2149f1d8357c9cc7fb7d0a",
      "reason": "added",
      "vulnerability": {
        "name": "CVE-2009-5155",
        "fixed_in_version": "v0.0.1",
        "links": "http://example.com/CVE-2009-5155",
        "description": "In the GNU C Library (aka glibc or libc6) before 2.28, parse_reg_exp in posix/regcomp.c misparses alternatives, which allows attackers to cause a denial of service (assertion failure and application exit) or trigger an incorrect result by attempting a regular-expression match.\"",
        "normalized_severity": "Unknown",
        "package": {
          "id": "10",
          "name": "libapt-pkg5.0",
          "version": "1.6.11",
          "kind": "BINARY",
          "arch": "x86",
          "source": {
            "id": "9",
            "name": "apt",
            "version": "1.6.11",
            "kind": "SOURCE",
            "source": null
          }
        },
        "distribution": {
          "id": "1",
          "did": "ubuntu",
          "name": "Ubuntu",
          "version": "18.04.3 LTS (Bionic Beaver)",
          "version_code_name": "bionic",
          "version_id": "18.04",
          "pretty_name": "Ubuntu 18.04.3 LTS"
        }
      }
    }
  ]
}

</code></pre>
<p>Notification Page</p>
<h3 id="properties-13"><a class="header" href="#properties-13">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>page</td><td>object</td><td>true</td><td>none</td><td>An object informing the client the next page to retrieve.</td></tr>
<tr><td>» size</td><td>integer</td><td>true</td><td>none</td><td>The number of notifications contained in this page.</td></tr>
<tr><td>» next</td><td>string</td><td>false</td><td>none</td><td>The identififer to pass into the "next" parameter of a future GetNotification request.<br><br>If not present, there are no additional pages.</td></tr>
<tr><td>notifications</td><td>[<a href="#schemanotification.schema.json">notification.schema.json</a>]</td><td>true</td><td>none</td><td>Notifications within this page.</td></tr>
</tbody></table>
</div><h2 id="tocS_notification"><a class="header" href="#tocS_notification">notification</a></h2>
<!-- backwards compatibility -->
<a id="schemanotification"></a>
<a id="schema_notification"></a>
<a id="tocSnotification"></a>
<a id="tocsnotification"></a>
<pre><code class="language-json">{
  "id": "string",
  "manifest": null,
  "reason": "added",
  "vulnerability": null
}

</code></pre>
<p>Notification</p>
<h3 id="properties-14"><a class="header" href="#properties-14">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>Unique identifier for this notification.</td></tr>
<tr><td>manifest</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The digest of the manifest affected by the provided vulnerability.</td></tr>
<tr><td>reason</td><td>any</td><td>true</td><td>none</td><td>The reason for the notifcation.</td></tr>
<tr><td>vulnerability</td><td><a href="#schemavulnerability_summary.schema.json">vulnerability_summary.schema.json</a></td><td>true</td><td>none</td><td>none</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values-2"><a class="header" href="#enumerated-values-2">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>reason</td><td>added</td></tr>
<tr><td>reason</td><td>removed</td></tr>
</tbody></table>
</div><h2 id="tocS_notification_webhook"><a class="header" href="#tocS_notification_webhook">notification_webhook</a></h2>
<!-- backwards compatibility -->
<a id="schemanotification_webhook"></a>
<a id="schema_notification_webhook"></a>
<a id="tocSnotification_webhook"></a>
<a id="tocsnotification_webhook"></a>
<pre><code class="language-json">{
  "notification_id": "string",
  "callback": "http://example.com"
}

</code></pre>
<p>Notification Webhook</p>
<h3 id="properties-15"><a class="header" href="#properties-15">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>notification_id</td><td>string</td><td>true</td><td>none</td><td>Unique identifier for this notification.</td></tr>
<tr><td>callback</td><td>string(uri)</td><td>true</td><td>none</td><td>A URL to retrieve paginated Notification objects.</td></tr>
</tbody></table>
</div><h2 id="tocS_package"><a class="header" href="#tocS_package">package</a></h2>
<!-- backwards compatibility -->
<a id="schemapackage"></a>
<a id="schema_package"></a>
<a id="tocSpackage"></a>
<a id="tocspackage"></a>
<pre><code class="language-json">{
  "id": "10",
  "name": "libapt-pkg5.0",
  "version": "1.6.11",
  "kind": "binary",
  "normalized_version": "",
  "arch": "x86",
  "module": "",
  "cpe": "",
  "source": {
    "id": "9",
    "name": "apt",
    "version": "1.6.11",
    "kind": "source",
    "source": null
  }
}

</code></pre>
<p>Package</p>
<h3 id="properties-16"><a class="header" href="#properties-16">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>false</td><td>none</td><td>Unique ID for this Package. May be unique to the response document, not the whole system.</td></tr>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Identifier of this Package.<br><br>The uniqueness and scoping of this name depends on the packaging system.</td></tr>
<tr><td>version</td><td>string</td><td>true</td><td>none</td><td>Version of this Package, as reported by the packaging system.</td></tr>
<tr><td>kind</td><td>any</td><td>false</td><td>none</td><td>The "kind" of this Package.</td></tr>
<tr><td>source</td><td><a href="#schema#">#</a></td><td>false</td><td>none</td><td>Source Package that produced the current binary Package, if known.</td></tr>
<tr><td>normalized_version</td><td>string</td><td>false</td><td>none</td><td>Normalized representation of the discoverd version.<br><br>The format is not specific, but is guarenteed to be forward compatible.</td></tr>
<tr><td>module</td><td>string</td><td>false</td><td>none</td><td>An identifier for intra-Repository grouping of packages.<br><br>Likely only relevant on rpm-based systems.</td></tr>
<tr><td>arch</td><td>string</td><td>false</td><td>none</td><td>Native architecture for the Package.</td></tr>
<tr><td>cpe</td><td><a href="#schemacpe.schema.json">cpe.schema.json</a></td><td>false</td><td>none</td><td>CPE Name for the Package.</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values-3"><a class="header" href="#enumerated-values-3">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>kind</td><td>BINARY</td></tr>
<tr><td>kind</td><td>SOURCE</td></tr>
</tbody></table>
</div><h2 id="tocS_range"><a class="header" href="#tocS_range">range</a></h2>
<!-- backwards compatibility -->
<a id="schemarange"></a>
<a id="schema_range"></a>
<a id="tocSrange"></a>
<a id="tocsrange"></a>
<pre><code class="language-json">{
  "[": "string",
  ")": "string"
}

</code></pre>
<p>Range</p>
<h3 id="properties-17"><a class="header" href="#properties-17">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>[</td><td>string</td><td>false</td><td>none</td><td>Lower bound, inclusive.</td></tr>
<tr><td>)</td><td>string</td><td>false</td><td>none</td><td>Upper bound, exclusive.</td></tr>
</tbody></table>
</div><h2 id="tocS_repository"><a class="header" href="#tocS_repository">repository</a></h2>
<!-- backwards compatibility -->
<a id="schemarepository"></a>
<a id="schema_repository"></a>
<a id="tocSrepository"></a>
<a id="tocsrepository"></a>
<pre><code class="language-json">{
  "id": "string",
  "name": "string",
  "key": "string",
  "uri": "http://example.com",
  "cpe": null
}

</code></pre>
<p>Repository</p>
<h3 id="properties-18"><a class="header" href="#properties-18">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>id</td><td>string</td><td>true</td><td>none</td><td>Unique ID for this Repository. May be unique to the response document, not the whole system.</td></tr>
<tr><td>name</td><td>string</td><td>false</td><td>none</td><td>Human-relevant name for the Repository.</td></tr>
<tr><td>key</td><td>string</td><td>false</td><td>none</td><td>Machine-relevant name for the Repository.</td></tr>
<tr><td>uri</td><td>string(uri)</td><td>false</td><td>none</td><td>URI describing the Repository.</td></tr>
<tr><td>cpe</td><td><a href="#schemacpe.schema.json">cpe.schema.json</a></td><td>false</td><td>none</td><td>CPE name for the Repository.</td></tr>
</tbody></table>
</div><h2 id="tocS_update_diff"><a class="header" href="#tocS_update_diff">update_diff</a></h2>
<!-- backwards compatibility -->
<a id="schemaupdate_diff"></a>
<a id="schema_update_diff"></a>
<a id="tocSupdate_diff"></a>
<a id="tocsupdate_diff"></a>
<pre><code class="language-json">{
  "prev": null,
  "cur": null,
  "added": [],
  "removed": []
}

</code></pre>
<p>Update Difference</p>
<h3 id="properties-19"><a class="header" href="#properties-19">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>prev</td><td><a href="#schemaupdate_operation.schema.json">update_operation.schema.json</a></td><td>false</td><td>none</td><td>The previous Update Operation.</td></tr>
<tr><td>cur</td><td><a href="#schemaupdate_operation.schema.json">update_operation.schema.json</a></td><td>true</td><td>none</td><td>The current Update Operation.</td></tr>
<tr><td>added</td><td>[<a href="#schemavulnerability.schema.json">vulnerability.schema.json</a>]</td><td>true</td><td>none</td><td>Vulnerabilities present in "cur", but not "prev".</td></tr>
<tr><td>removed</td><td>[<a href="#schemavulnerability.schema.json">vulnerability.schema.json</a>]</td><td>true</td><td>none</td><td>Vulnerabilities present in "prev", but not "cur".</td></tr>
</tbody></table>
</div><h2 id="tocS_update_operation"><a class="header" href="#tocS_update_operation">update_operation</a></h2>
<!-- backwards compatibility -->
<a id="schemaupdate_operation"></a>
<a id="schema_update_operation"></a>
<a id="tocSupdate_operation"></a>
<a id="tocsupdate_operation"></a>
<pre><code class="language-json">{
  "ref": "d0fad5d6-e996-4437-8fb9-5f40bbcfd7cc",
  "updater": "string",
  "fingerprint": "string",
  "date": "2019-08-24T14:15:22Z",
  "kind": "vulnerability"
}

</code></pre>
<p>Update Operation</p>
<h3 id="properties-20"><a class="header" href="#properties-20">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>ref</td><td>string(uuid)</td><td>true</td><td>none</td><td>A unique identifier for this update operation.</td></tr>
<tr><td>updater</td><td>string</td><td>true</td><td>none</td><td>The "updater" component that was run.</td></tr>
<tr><td>fingerprint</td><td>string</td><td>true</td><td>none</td><td>The stored "fingerprint" of this run.</td></tr>
<tr><td>date</td><td>string(date-time)</td><td>true</td><td>none</td><td>When this operation was run.</td></tr>
<tr><td>kind</td><td>any</td><td>true</td><td>none</td><td>The kind of data this operation updated.</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values-4"><a class="header" href="#enumerated-values-4">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>kind</td><td>vulnerability</td></tr>
<tr><td>kind</td><td>enrichment</td></tr>
</tbody></table>
</div><h2 id="tocS_update_operations"><a class="header" href="#tocS_update_operations">update_operations</a></h2>
<!-- backwards compatibility -->
<a id="schemaupdate_operations"></a>
<a id="schema_update_operations"></a>
<a id="tocSupdate_operations"></a>
<a id="tocsupdate_operations"></a>
<pre><code class="language-json">{
  "property1": [],
  "property2": []
}

</code></pre>
<p>Update Operations</p>
<h3 id="properties-21"><a class="header" href="#properties-21">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>additionalProperties</strong></td><td>[<a href="#schemaupdate_operation.schema.json">update_operation.schema.json</a>]</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_vulnerability_core"><a class="header" href="#tocS_vulnerability_core">vulnerability_core</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerability_core"></a>
<a id="schema_vulnerability_core"></a>
<a id="tocSvulnerability_core"></a>
<a id="tocsvulnerability_core"></a>
<pre><code class="language-json">{
  "name": "string",
  "fixed_in_version": "string",
  "severity": "string",
  "normalized_severity": null,
  "range": null,
  "arch_op": "equals",
  "package": null,
  "distribution": null,
  "repository": null
}

</code></pre>
<p>Vulnerability Core</p>
<h3 id="properties-22"><a class="header" href="#properties-22">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>name</td><td>string</td><td>true</td><td>none</td><td>Human-readable name, as presented in the vendor data.</td></tr>
<tr><td>fixed_in_version</td><td>string</td><td>false</td><td>none</td><td>Version string, as presented in the vendor data.</td></tr>
<tr><td>severity</td><td>string</td><td>false</td><td>none</td><td>Severity, as presented in the vendor data.</td></tr>
<tr><td>normalized_severity</td><td><a href="#schemanormalized_severity.schema.json">normalized_severity.schema.json</a></td><td>true</td><td>none</td><td>A well defined set of severity strings guaranteed to be present.</td></tr>
<tr><td>range</td><td><a href="#schemarange.schema.json">range.schema.json</a></td><td>false</td><td>none</td><td>Range of versions the vulnerability applies to.</td></tr>
<tr><td>arch_op</td><td>any</td><td>false</td><td>none</td><td>Flag indicating how the referenced package's "arch" member should be interpreted.</td></tr>
<tr><td>package</td><td><a href="#schemapackage.schema.json">package.schema.json</a></td><td>false</td><td>none</td><td>A package description</td></tr>
<tr><td>distribution</td><td><a href="#schemadistribution.schema.json">distribution.schema.json</a></td><td>false</td><td>none</td><td>A distribution description</td></tr>
<tr><td>repository</td><td><a href="#schemarepository.schema.json">repository.schema.json</a></td><td>false</td><td>none</td><td>A repository description</td></tr>
</tbody></table>
</div>
<p>anyOf</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>object</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div>
<p>or</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>object</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div>
<p>or</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td><em>anonymous</em></td><td>object</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div>
<h4 id="enumerated-values-5"><a class="header" href="#enumerated-values-5">Enumerated Values</a></h4>
<div class="table-wrapper"><table><thead><tr><th>Property</th><th>Value</th></tr></thead><tbody>
<tr><td>arch_op</td><td>equals</td></tr>
<tr><td>arch_op</td><td>not equals</td></tr>
<tr><td>arch_op</td><td>pattern match</td></tr>
</tbody></table>
</div><h2 id="tocS_vulnerability_report"><a class="header" href="#tocS_vulnerability_report">vulnerability_report</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerability_report"></a>
<a id="schema_vulnerability_report"></a>
<a id="tocSvulnerability_report"></a>
<a id="tocsvulnerability_report"></a>
<pre><code class="language-json">{
  "manifest_hash": null,
  "packages": {},
  "distributions": {},
  "repository": {},
  "environments": {
    "property1": [],
    "property2": []
  },
  "vulnerabilities": {},
  "package_vulnerabilities": {
    "property1": [
      "string"
    ],
    "property2": [
      "string"
    ]
  },
  "enrichments": {
    "property1": [],
    "property2": []
  }
}

</code></pre>
<p>Vulnerability Report</p>
<h3 id="properties-23"><a class="header" href="#properties-23">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>manifest_hash</td><td><a href="#schemadigest.schema.json">digest.schema.json</a></td><td>true</td><td>none</td><td>The Manifest's digest.</td></tr>
<tr><td>packages</td><td>object</td><td>true</td><td>none</td><td>A map of Package objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemapackage.schema.json">package.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>distributions</td><td>object</td><td>true</td><td>none</td><td>A map of Distribution objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemadistribution.schema.json">distribution.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>repository</td><td>object</td><td>false</td><td>none</td><td>A map of Repository objects indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemarepository.schema.json">repository.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>environments</td><td>object</td><td>true</td><td>none</td><td>A map of Environment arrays indexed by a Package's identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[<a href="#schemaenvironment.schema.json">environment.schema.json</a>]</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A map of Vulnerabilities indexed by a document-local identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td><a href="#schemavulnerability.schema.json">vulnerability.schema.json</a></td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>package_vulnerabilities</td><td>object</td><td>true</td><td>none</td><td>A mapping of Vulnerability identifier lists indexed by Package identifier.</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>[string]</td><td>false</td><td>none</td><td>none</td></tr>
<tr><td>enrichments</td><td>object</td><td>false</td><td>none</td><td>A mapping of extra "enrichment" data by type</td></tr>
<tr><td>» <strong>additionalProperties</strong></td><td>array</td><td>false</td><td>none</td><td>none</td></tr>
</tbody></table>
</div><h2 id="tocS_vulnerability"><a class="header" href="#tocS_vulnerability">vulnerability</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerability"></a>
<a id="schema_vulnerability"></a>
<a id="tocSvulnerability"></a>
<a id="tocsvulnerability"></a>
<pre><code class="language-json">false

</code></pre>
<p>Vulnerability</p>
<h3 id="properties-24"><a class="header" href="#properties-24">Properties</a></h3>
<p><em>None</em></p>
<h2 id="tocS_vulnerability_summaries"><a class="header" href="#tocS_vulnerability_summaries">vulnerability_summaries</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerability_summaries"></a>
<a id="schema_vulnerability_summaries"></a>
<a id="tocSvulnerability_summaries"></a>
<a id="tocsvulnerability_summaries"></a>
<pre><code class="language-json">[]

</code></pre>
<p>Vulnerability Summaries</p>
<h3 id="properties-25"><a class="header" href="#properties-25">Properties</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Type</th><th>Required</th><th>Restrictions</th><th>Description</th></tr></thead><tbody>
<tr><td>Vulnerability Summaries</td><td>[<a href="#schemavulnerability_summary.schema.json">vulnerability_summary.schema.json</a>]</td><td>false</td><td>none</td><td><strong>This is an internal type, documented for completeness.</strong><br><br>This is an array of pseudo-Vulnerability objects used for reverse-lookup.</td></tr>
</tbody></table>
</div><h2 id="tocS_vulnerability_summary"><a class="header" href="#tocS_vulnerability_summary">vulnerability_summary</a></h2>
<!-- backwards compatibility -->
<a id="schemavulnerability_summary"></a>
<a id="schema_vulnerability_summary"></a>
<a id="tocSvulnerability_summary"></a>
<a id="tocsvulnerability_summary"></a>
<pre><code class="language-json">false

</code></pre>
<p>Vulnerability Summary</p>
<h3 id="properties-26"><a class="header" href="#properties-26">Properties</a></h3>
<p><em>None</em></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../reference.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../reference/clairctl.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../reference.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../reference/clairctl.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
